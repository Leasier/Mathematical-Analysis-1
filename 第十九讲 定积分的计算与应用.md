# 第十九讲 定积分的计算与应用

### 将序列极限转化为 Riemann 积分

[例 1] 求 $\displaystyle\lim_{n \to +\infty} \sum_{k = 1}^n \frac{1}{n + k}$。

注意到 $\dfrac{1}{n + k} = \dfrac{1}{1 + \frac{k}{n}} \cdot \dfrac{1}{n}$，考虑将求和转化为 Riemann 和：

- 令 $f(x) = \dfrac{1}{1 + x}$。
- 取分割 $P : \dfrac{0}{n}, \dfrac{1}{n}, \cdots, \dfrac{n}{n}$，$\xi = (\dfrac{1}{n}, \cdots, \dfrac{n}{n})$。
- 则 $\displaystyle\sum_{k = 1}^n \frac{1}{n + k} = \sum_{k = 1}^n f(\xi_i) \Delta x_i$，且 $|P| = \dfrac{1}{n}$。

由于 $\displaystyle\lim_{n \to +\infty} |P| = 0$，Riemann 和收敛于 Riemann 积分，故 $\displaystyle\lim_{n \to +\infty} \sum_{k = 1}^n \frac{1}{n + k} = \int_0^1 \frac{1}{1 + x} \text{d} x = \ln 2$。

[例 2] 求 $\displaystyle\lim_{n \to +\infty} \sum_{k = 1}^n \frac{n}{n^2 + k^2}$。

$$
\begin{aligned}
\lim_{n \to +\infty} \sum_{k = 1}^n \frac{n}{n^2 + k^2} &= \lim_{n \to +\infty} \sum_{k = 1}^n \frac{1}{1 + (\frac{k}{n})^2} \cdot \frac{1}{n} \\
&= \int_0^1 \frac{1}{1 + x^2} \text{d} x \\
&= \arctan 1
\end{aligned}
$$

[例 3] 当 $p \geq 0$，求 $\displaystyle\lim_{n \to +\infty} \sum_{k = 1}^n \frac{k^p}{n^{p + 1}}$。

当 $p = 0$，答案显然为 $1$；下面讨论 $p > 0$ 的情况。

$$
\begin{aligned}
\lim_{n \to +\infty} \sum_{k = 1}^n \frac{k^p}{n^{p + 1}} &= \lim_{n \to +\infty} \sum_{k = 1}^n (\frac{k}{n})^p \cdot \frac{1}{n} \\
&= \int_0^1 x^p \text{d} x \\
&= \frac{1}{p + 1}
\end{aligned}
$$

### 定积分的计算

- _其实就是把不定积分的那一坨搬过来了（_

#### 定义：连续可微

称 $f$ 在 $(a, b)$ 上连续可微（记作 $f \in C^1(a, b)$），若 $f$ 在 $(a, b)$ 上可导，且 $f' \in C(a, b)$。

称 $f$ 在 $[a, b]$ 上连续可微（记作 $f \in C^1 [a, b]$），若 $f$ 在 $(a, b)$ 上可导、在 $a$ 处右侧可导、在 $b$ 处左侧可导，且 $f' \in C[a, b]$。

#### 换元法

条件：

- (1) $f \in C[a, b], \varphi \in C^1 [\alpha, \beta]$。
- (2) $\varphi(\alpha) = a, \varphi(\beta) = b, \varphi([\alpha, \beta]) \subset [a, b]$。

结论：$\displaystyle\int_a^b f(x) \text{d} x = \int_{\alpha}^{\beta} f(\varphi(t)) \varphi'(t) \text{d} t$。

- **注意：这里不要求 $\varphi$ 在 $[\alpha, \beta]$ 上有反函数！**

证明：

- 取 $f$ 在 $[a, b]$ 上的一个原函数为 $F$，则：

$$
\begin{aligned}
\int_a^b f(x) \text{d} x &= F(b) - F(a) \\
&= F(\varphi(\beta)) - F(\varphi(\alpha)) \\
&= \int_{\alpha}^{\beta} (F \circ \varphi)'(t) \text{d} t \\
&= \int_{\alpha}^{\beta} f(\varphi(t)) \varphi'(t) \text{d} t
\end{aligned}
$$

[例 4] 求 $\displaystyle\int_0^1 \sqrt{1 - x^2} \text{d} x$。

换元 $x = \sin t \ (t \in [0, \dfrac{\pi}{2}])$，则：

$$
\begin{aligned}
\int_0^1 \sqrt{1 - x^2} \text{d} x &= \int_0^{\frac{\pi}{2}} \cos t \text{d} (\sin t) \\
&= \int_0^{\frac{\pi}{2}} \cos^2 t \text{d} t \\
&= \frac{1}{2} \int_0^{\frac{\pi}{2}} (1 + \cos 2t) \text{d} t) \\
&= \frac{1}{2} \left. (t + \frac{\sin (2t)}{2}) \right|_0^{\frac{\pi}{2}} \\
&= \frac{\pi}{4}
\end{aligned}
$$

#### 分部积分法

条件：$u, v \in C^1 [a, b]$。

结论：$\displaystyle\int_a^b u(x) v'(x) \text{d} x = \left. (u(x) v(x)) \right|_a^b - \int_a^b u'(x) v(x) \text{d} x$。


证明：由不定积分的分部积分公式立即可得。

[例 5] 求 $\displaystyle\int_0^{\pi} x \sin x \text{d} x$。

$$
\begin{aligned}
\int_0^{\pi} x \sin x \text{d} x &= -\int_0^{\pi} x \text{d} (\cos x) \\
&= -(\left. (x \cos x) \right|_0^{\pi} - \int_0^{\pi} \cos x \text{d} x) \\
&= \pi + \left. \sin x \right|_0^{\pi} \\
&= \pi
\end{aligned}
$$

#### 带积分余项与 Cauchy 余项的 Taylor 公式

##### 引理（$[0, 1]$ 上的情况）

条件：$f \in C^{n + 1} [0, 1]$。

结论：$f(1) = \displaystyle\sum_{i = 0}^n \frac{f^{(i)}(0)}{i!} + \frac{1}{n!} \int_0^1 f^{(n + 1)}(t) (1 - t)^n \text{d} t$。

证明：

- 考虑数学归纳法：
- (1) 当 $n = 0$，由 Newton-Leibnitz 公式可知 $f(1) - f(0) = \displaystyle\int_0^1 f'(t) \text{d} t$，结论成立。
- (2) 若结论对 $n = k$ 成立，欲证其对 $n = k + 1$ 也成立。
- _Motivation：我要造出更高阶的导数。_
- 考虑用**分部积分法**改写后面那一项：

$$
\begin{aligned}
\frac{1}{k!} \int_0^1 f^{(k + 1)}(t) (1 - t)^k \text{d} t &= -\frac{1}{(k + 1)!} \int_0^1 f^{(k + 1)}(t) \text{d} ((1 - t)^{k + 1}) \\
&= -\frac{1}{(k + 1)!} (\left. (f^{k + 1} (t) (1 - t)^{k + 1}) \right|_0^1 - \int_0^1 (1 - t)^{k + 1} \text{d} (f^{k + 1}(t)) \\
&= \frac{1}{(k + 1)!} (f^{k + 1}(0) - \int_0^1 f^{(k + 2)}(t) (1 - t)^{k + 1} \text{d} t)
\end{aligned}
$$

- 代入 $n = k$ 的结论即得：

$$
f(1) = \displaystyle\sum_{i = 0}^{k + 1} \frac{f^{(i)}(0)}{i!} + \frac{1}{(k + 1)!} \int_0^1 f^{(k + 2)}(t) (1 - t)^{k + 1} \text{d} t
$$

##### 定理（一般情况）

条件：

- (1) $f \in C^{n + 1} (I)$。
- (2) $a, x \in I \land a \neq x$。

结论：

- (1) 积分余项：$f(x) = \displaystyle\sum_{i = 0}^n \frac{f^{(i)}(a)}{i!} \cdot (x - a)^i + \frac{(x - a)^{n + 1}}{n!} \int_0^1 f^{(n + 1)}((1 - t) a + tx) (1 - t)^n \text{d} x$。
- (2) Cauchy 余项：$\exists \theta \in (0, 1), \text{s.t. } f(x) = \displaystyle\sum_{i = 0}^n \frac{f^{(i)}(a)}{i!} \cdot (x - a)^i + \frac{(1 - \theta)^n}{n!} f^{(n + 1)}((1 - \theta) a + \theta x) \cdot (x - a)^{n + 1}$。

证明：

- 令 $g(t) = f((1 - t) a + tx)$，对 $g$ 应用引理可得：

$$
\begin{aligned}
g(1) &= \sum_{i = 0}^n \frac{g^{(i)}(0)}{i!} + \frac{1}{n!} \int_0^1 g^{(n + 1)}(t) (1 - t)^n \text{d} t \\
\Leftrightarrow f(x) &= \sum_{i = 0}^n \frac{f^{(i)}(a)}{i!} \cdot (x - a)^i + \frac{(x - a)^{n + 1}}{n!} \int_0^1 f^{(n + 1)}((1 - t) a + tx) (1 - t)^n \text{d} x 
\end{aligned}
$$

- 对后面那坨积分应用积分第一中值定理，可知：

$$
\exists \theta \in (0, 1), \text{s.t. } f(x) = \sum_{i = 0}^n \frac{f^{(i)}(a)}{i!} \cdot (x - a)^i + \frac{(1 - \theta)^n}{n!} f^{(n + 1)}((1 - \theta) a + \theta x) \cdot (x - a)^{n + 1}
$$

[例 6] 求证：

- (1) $\forall x > -1, \ln(1 + x) \leq x$，其中等号当且仅当 $x = 0$ 时取得。
- 当 $x = 0$，上式取等。
- 当 $x > -1 \land x \neq 0$，写出 $\ln (1 + x)$ 的带积分余项的二阶 Taylor 展开式：

$$
\exists \theta \in (0, 1), \text{s.t. } \ln (1 + x) = x - (\frac{(1 - \theta) x}{1 + \theta x})^2 < x
$$

- 综上，$\forall x > -1, \ln(1 + x) \leq x$，其中等号当且仅当 $x = 0$ 时取得。
- (2) $\ln (1 + x)$ 在 $(-1, 1]$ 上解析。
- 写出 $\ln (1 + x)$ 的 $n$ 阶积分余项 $R_n(x)$：

$$
\exists \theta_n \in (0, 1), \text{s.t. } R_n(x) = (-1)^n \cdot \frac{(1 - \theta_n)^n x^{n + 1}}{(1 + \theta_n x)^{n + 1}}
$$

- 当 $x \in (-1, 0)$，有：

$$
\begin{aligned}
|R_n(x)| &= |\frac{(1 - \theta_n)^n x^{n + 1}}{(1 + \theta_n x)^{n + 1}}| \\
&= (\frac{1 - \theta_n}{1 + \theta_n x})^n \cdot \frac{|x|^{n + 1}}{1 + \theta_n x} \\
&< (\frac{1 - \theta_n}{1 - \theta_n |x|})^n \cdot \frac{|x|^{n + 1}}{1 - |x|} \\
&< 1^n \cdot \frac{|x|^{n + 1}}{1 - |x|} \\
&= \frac{|x|^{n + 1}}{1 - |x|}
\end{aligned}
$$

- 又由于 $\displaystyle\lim_{n \to +\infty} \frac{|x|^{n + 1}}{1 - |x|} = 0$，可知 $\displaystyle\lim_{n \to +\infty} R_n(x) = 0$，故 $\ln (1 + x)$ 在 $(-1, 0)$ 上解析。
- 又通过 Taylor 展开的 Lagrange 余项可以证明 $\ln (1 + x)$ 在 $[0, 1]$ 上解析，故 $\ln (1 + x)$ 在 $(-1, 1]$ 上解析。

### 平面图形面积计算

Riemann 积分提供了一种定义“面积”的方式。

- _当然，还有其他定义“面积”的方式，如 Lesbegue 积分。_

#### 直角坐标系下的计算

[例 7] 求椭圆 $C : \dfrac{x^2}{a^2} + \dfrac{y^2}{b^2} = 1 \ (a, b > 0)$ 的面积。

考虑计算 $x, y \geq 0$ 部分的 $\dfrac{1}{4}$ 椭圆的面积 $S_0$。在该区域内，$y = b \sqrt{1 - (\dfrac{x}{a})^2}$，则：

$$
\begin{aligned}
S_0 &= \int_0^a b \sqrt{1 - (\frac{x}{a})^2} \text{d} x \\
&= ab \int_0^1 \sqrt{1 - t^2} \text{d} t &\quad (t = \frac{x}{a}) \\
&= ab \cdot \frac{\pi}{4} &\quad (由例 4 的结果可知)
\end{aligned}
$$

故 $C$ 的面积为 $4 S_0 = \pi ab$。

[例 8] 求抛物线 $E : y^2 = 2x$ 被直线 $y = x - 4$ 分开的左部图形的面积。

![](pictures/19-1.png)

考虑转换到 $yOx$ 坐标系中，此时 $E : x = \dfrac{1}{2} y^2$，直线方程为 $x = y + 4$，则答案为：

$$
\begin{aligned}
\int_{-2}^4 ((y + 4) - \frac{1}{2} y^2) \text{d} y &= -\frac{1}{2} \left. (\frac{1}{3} y^3) \right|_{-2}^4 + \left. \frac{1}{2} y^2 \right|_{-2}^4 + 4 \left. y \right|_{-2}^4 \\
&= -12 + 6 + 24 \\
&= 18
\end{aligned}
$$

[例 9] 求 $\displaystyle\int_0^1 (\sin (\frac{\pi}{2} x) + \frac{2}{\pi} \arcsin x) \text{d} x$。

注意到 $y = \sin (\dfrac{\pi}{2} x), x = \dfrac{2}{\pi} \arcsin y$ 在 $[0, 1]$ 上互为反函数，考虑作图：

![](pictures/19-2.png)

可以发现，$\displaystyle\int_0^1 \sin (\frac{\pi}{2} x) \text{d} x$ 就是灰色曲线、$x$ 轴与绿色直线围成的面积，$\displaystyle\int_0^1 \dfrac{2}{\pi} \arcsin y \text{d} y$ 就是灰色曲线、$y$ 轴与蓝色直线围成的面积。

注意到两块拼起来起来恰好为 $[0, 1] \times [0, 1]$ 的正方形，则 $\displaystyle\int_0^1 (\sin (\frac{\pi}{2} x) + \frac{2}{\pi} \arcsin x) \text{d} x = \int_0^1 \sin (\frac{\pi}{2} x) \text{d} x + \int_0^1 \dfrac{2}{\pi} \arcsin y \text{d} y = 1 \times 1 = 1$。

#### 极坐标下的计算

对于由 $r = r(\theta)$ 确定的图形，欲求由原点、$(r(\alpha), \alpha)$ 和 $(r(\beta), \beta)$ 围成的图形的面积。

在 $r$ 恒定的理想情况下，我们计算的是“扇形”面积。仿照直角坐标系下用长方形拟合面积，考虑用**扇形**拟合面积：

- 考虑 $[\theta, \theta + \Delta \theta]$ 的部分（“微元”）。
- 该部分的面积 $\Delta S$ 满足 $\dfrac{1}{2} \Delta \theta \displaystyle\min_{\varphi \in [\theta, \theta + \Delta]} r^2 (\theta) \leq \Delta S \leq \frac{1}{2} \Delta \theta \max_{\varphi \in [\theta, \theta + \Delta]} r^2 (\theta)$。
- 对“微元”累积，可以发现我们得到的是 **Riemann 和**，即总面积 $S$ 满足 $L(\dfrac{1}{2} r^2, P) \leq S \leq U(\dfrac{1}{2} r^2, P)$。

故当 $r$ 在 $[\alpha, \beta]$ 上 Riemann 可积，$\dfrac{1}{2} r^2$ 也在 $[\alpha, \beta]$ 上 Riemann 可积，则 $S = \displaystyle\int_{\alpha}^{\beta} \frac{1}{2} r^2(\theta) \text{d} \theta$。

[例 10] 求双纽线 $r^2 = a^2 \cos 2 \theta \ (a > 0, \theta \in [-\pi, -\dfrac{3 \pi}{4}] \cup [-\dfrac{\pi}{4}, \dfrac{\pi}{4}], [\dfrac{3 \pi}{4}, \pi])$ 围成图形的面积。

![](pictures/19-3.png)

- 注：这里给出的是 $a = 1$ 的图像。

考虑计算 $x, y \geq 0$ 部分的 $\dfrac{1}{4}$ 于整个图形的面积 $S_0$，此区域内 $\theta \in [0, \dfrac{\pi}{4}]$，则：

$$
\begin{aligned}
S_0 &= \int_0^{\frac{\pi}{4}} \frac{1}{2} a^2 \cos 2 \theta \text{d} \theta \\
&= \frac{1}{4} a^2 \int_0^{\frac{\pi}{2}} \sin t \text{d} t &\quad (t = 2 \theta) \\
&= \frac{1}{4} a^2 \left. (-\cos t) \right|_0^{\frac{\pi}{2}} \\
&= \frac{1}{4} a^2
\end{aligned}
$$

故整个图形的面积为 $4 S_0 = a^2$。

[例 11] 求心形线 $r = a(1 + \cos \theta) \ (a > 0, \theta \in [0, 2 \pi])$ 围成图形的面积。

![](pictures/19-4.png)

- 注：这里给出的是 $a = 1$ 的图像。

$$
\begin{aligned}
S &= \int_0^{2 \pi} \frac{1}{2} a^2 (1 + \cos \theta)^2 \text{d} \theta \\
&= \frac{1}{2} a^2 (\int_0^{2 \pi} 1 \cdot \text{d} \theta + 2 \int_0^{2 \pi} \cos \theta \text{d} \theta + \int_0^{2 \pi} \cos^2 \theta \text{d} \theta) \\
&= \frac{1}{2} a^2 (\left. \theta \right|_0^{2 \pi} + 2 \left. (\sin \theta) \right|_0^{2 \pi} + \frac{1}{2} \left. (\theta + \frac{\sin (2\theta)}{2}) \right|_0^{2 \pi}) \\
&= \frac{3}{2} \pi a^2
\end{aligned}
$$

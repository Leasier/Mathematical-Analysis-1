# 第十八讲 定积分与可积条件

### 引入：曲线下方面积的计算

考虑函数 $f(x) = x^2$，现在我们想要求出它在 $[0, 1]$ 上与坐标轴夹出的面积 $S$。

考虑将 $[0, 1]$ 切分为 $n$ 段，每段形如 $i \in \mathbb{N}_{< n}, [\dfrac{i}{n}, \dfrac{i + 1}{n}]$，则段内面积在 $(\dfrac{i^2}{n^3}, \dfrac{(i + 1)^2}{n^3})$ 之间。

故 $\dfrac{1}{3} (1 - \dfrac{1}{n}) (1 - \dfrac{1}{2n}) = \displaystyle\sum_{i = 0}^{n - 1} \frac{i^2}{n^3} < S < \sum_{i = 0}^{n - 1} \frac{(i + 1)^2}{n^3} = \dfrac{1}{3} (1 + \dfrac{1}{n}) (1 + \dfrac{1}{2n})$。

令 $n \to +\infty$，由夹挤原理即得 $S = \dfrac{1}{3}$。

### 定义：定积分

考察在 $[a, b]$ 上有定义的函数 $f$，取一组点 $a = x_0 < x_1 < \cdots < x_{n - 1} < x_n = b$ 构成一个**分割** $P$。

令 $\forall i \in [1, n] \cap \mathbb{N}, \Delta_i = x_i - x_{i - 1}$。

- _Motivation：从上面的“引入”部分可以看出，$\Delta_i$ 越小，则分割得“越细”。能不能给出一个量来描述这种“精细程度”？_

定义分割 $P$ 的模为 $|P| = \displaystyle\max_{i = 1}^n \Delta x_i$。

在每一个区间 $\forall i \in [1, n] \cap \mathbb{N}, [x_{i - 1}, x_i]$ 上任选一个标志点 $\xi_i$，构成标志点组 $\xi$。

对于**选定**的 $f, P, \xi$，定义 Riemann 和为 $\sigma(f, P, \xi) = \displaystyle\sum_{i = 1}^n f(\xi_i) \Delta x_i$。

我们称 $f$ 在 $[a, b]$ 上 Riemann 可积（简称可积），当且仅当：

$$
\exists I \in \mathbb{R}, \text{s.t. } \forall \epsilon > 0, \exists \delta > 0, \text{s.t. } \forall ||P|| < \delta, \forall \xi, |\sigma(f, P, \xi) - I| < \epsilon
$$

此时称 $I$ 为 $f$ 在 $[a, b]$ 上的 Riemann 积分（简称（定）积分），记作 $\displaystyle\int_a^b f(x) \text{d} x$，其中 $a, b$ 分别称为该积分的下、上限。

### 定积分的性质

#### 定积分的线性性

内容：若 $f, g$ 在 $[a, b]$ 上可积，则 $\forall f, g \in \mathbb{R}, \alpha f + \beta g$ 在 $[a, b]$ 上可积，且 $\displaystyle\int_a^b (\alpha f(x) + \beta g(x)) \text{d} x = \alpha \int_a^b f(x) \text{d} x + \beta \int_a^b g(x) \text{d} x$。

证明略。

#### 被积函数的有界性

内容：若 $f$ 在 $[a, b]$ 上可积，则 $f$ 在 $[a, b]$ 上有界。

证明：

- 考虑反证法，假设 $f$ 在 $[a, b]$ 上无界。
- $\forall I \in \mathbb{R}, \forall \delta > 0, \exists$ 长为 $\dfrac{\delta}{2}$ 的子区间 $[x_k, x_{k + 1}]$，$\text{s.t. } f$ 在 $[x_k, x_{k + 1}]$ 上无界。
- 接下来选取 $x_1, \cdots, x_{k - 1}, x_{k + 2}, \cdots, x_{n - 1}$，使得 $|P| = \dfrac{\delta}{2}$。
- 随后选取 $\xi_1, \cdots, \xi_k, \xi_{k + 2}, \cdots, \xi_n$，令 $s = \displaystyle\sum_{i \neq k} f(\xi_i) \Delta x_i$。
- 由无界可知 $\exists \xi_{k + 1} \in [x_k, x_{k + 1}], \text{s.t. } |f(\xi_{k + 1})| > \dfrac{2}{\delta} (|s - I| + 1)$。
- 令 $\epsilon_0 = 1$，则 $\sigma(f, P, \xi) = |s + \dfrac{2}{\delta} f(\xi_{k + 1}) - I| \geq ||\dfrac{2}{\delta} f(\xi_{k + 1})| - |s - I|| > 1 = \epsilon_0$。
- 故 $f$ 在 $[a, b]$ 上不可积，矛盾。故 $f$ 在 $[a, b]$ 上有界。

#### 定积分的可加性

内容：若 $f$ 在 $[a, b], [b, c]$ 上分别可积，则 $f$ 在 $[a, c]$ 上可积，且 $\displaystyle\int_a^c f(x) \text{d} x = \int_a^b f(x) \text{d} x + \int_b^c f(x) \text{d} x$。

证明：把 $[a, c]$ 的分割拆成 $[a, b], [b, c]$ 中的两块，再利用 $f$ 的有界性解决 $b$ 附近的问题即可，略。

------

方便起见，定义 $\displaystyle\int_a^a f(x) \text{d} x = 0$，并在 $a < b$ 时定义 $\displaystyle\int_b^a f(x) \text{d} x = -\int_a^b f(x) \text{d} x$，容易验证定积分的可加性仍然成立。

#### 定积分的单调性

内容：若 $f, g$ 在 $[a, b]$ 上可积，且 $\forall x \in [a, b], f(x) \leq g(x)$，则 $\displaystyle\int_a^b f(x) \text{d} x \leq \int_a^b g(x) \text{d} x$。

证明：

- 定义 $h(x) = g(x) - f(x)$，则 $h$ 在 $[a, b]$ 上可积，且 $\displaystyle\int_a^b h(x) \text{d} x = \int_a^b g(x) \text{d} x - \int_a^b f(x) \text{d} x$。
- 于是 $h$ 在 $[a, b]$ 上的 Riemann 和 $\sigma(h, P, \xi) = \displaystyle\sum_{i = 1}^n h(\xi_i) \Delta x_i \geq 0$，故 $\displaystyle\int_a^b h(x) \text{d} x = \lim_{|P| \to 0} \sigma(h, P, \xi) \geq 0$。
- 因此 $\displaystyle\int_a^b f(x) \text{d} x \leq \int_a^b g(x) \text{d} x$。

#### 积分中值定理 / 第一中值定理

内容：

- (1) 若 $f$ 在 $[a, b]$ 上可积，且 $f$ 在 $[a, b]$ 上有上、下界分别为 $M, m$，则 $m(b - a) \leq \displaystyle\int_a^b f(x) \text{d} x \leq M(b - a)$。
- (2) 在 (1) 的基础上，若 $f \in C[a, b]$，则 $\exists \xi \in [a, b], \text{s.t. } \displaystyle\int_a^b f(x) \text{d} x = f(\xi) (b - a)$。

证明：

- (1) $f$ 在 $[a, b]$ 上的 Riemann 和 $\sigma(f, P, \xi) = \displaystyle\sum_{i = 1}^n f(\xi_i) \Delta x_i \geq \sum_{i = 1}^n m \Delta x_i = m(b - a)$，故 $\displaystyle\int_a^b f(x) \text{d} x = \lim_{|P| \to 0} \sigma(f, P, \xi) \geq m(b - a)$。
- 同理有 $\displaystyle\int_a^b f(x) \text{d} x \leq M(b - a)$，遂得证。
- (2) 由 $f \in C[a, b]$，可取 $\exists x_1, x_2 \in [a, b], \text{s.t. } f(x_1) = \displaystyle\min_{x \in [a, b]} f(x), f(x_2) = \max_{x \in [a, b]} f(x)$。
- 令 $m = f(x_1), M = f(x_2)$，由 (1) 可知 $f(x_1) (b - a) \leq \displaystyle\int_a^b f(x) \text{d} x \leq f(x_2) (b - a)$。
- 故 $f(x_1) \leq \dfrac{1}{b - a} \displaystyle\int_a^b f(x) \text{d} x \leq f(x_2)$，进而由连续函数的介质性可知 $\exists \xi \in [a, b], \text{s.t. } f(\xi) = \dfrac{1}{b - a} \displaystyle\int_a^b f(x) \text{d} x \Leftrightarrow \int_a^b f(x) \text{d} x = f(\xi) (b - a)$。

### 可积条件

- _Motivation：如果可积，那么在分割的每一个区间中，取“最小的”和“最大的”应当差得“不太多”。_

#### Darboux 上下和

若 $f$ 在 $[a, b]$ 上有界，对于 $[a, b]$ 的一个分割 $P$，设其分割点为 $a = x_0 < x_1 < \cdots < x_{n - 1} < x_n = b$，令 $\forall i \in [1, n] \cap \mathbb{N}, m_i = \displaystyle\inf_{x \in [x_{i - 1}, x_i]} f(x), M_i = \sup_{x \in [x_{i - 1}, x_i]} f(x)$，然后定义：

- Darboux 下和（“全都取最低的标志点”）：$L(f, P) = \displaystyle\sum_{i = 1}^n m_i \Delta x_i = \inf_{\xi} \sigma(f, P, \xi)$。
- Darboux 上和（“全都取最高的标志点”）：$U(f, P) = \displaystyle\sum_{i = 1}^n M_i \Delta x_i = \sup_{\xi} \sigma(f, P, \xi)$。

#### 定理（Darboux 上下和的极限）

内容：若 $f$ 在 $[a, b]$ 上有界，则：

- (1) $\displaystyle\lim_{|P| \to 0} L(f, P) = \sup_P L(f, P) \equiv \underline{I} \in \mathbb{R}$，
- (2) $\displaystyle\lim_{|P| \to 0} U(f, P) = \inf_P U(f, P) \equiv \overline{I} \in \mathbb{R}$。
- (3) $\underline{I} \leq \overline{I}$。

证明：

- (1) 由 $f$ 在 $[a, b]$ 上有界可知其有上、下界 $M, m \in \mathbb{R}$。
- 由 $L(f, P) \geq m(b - a)$ 可知其有下确界 $\underline{I} = \displaystyle\sup_P L(f, P) \in \mathbb{R}$。
- 由下确界的性质可知 $\forall \epsilon > 0, \exists P_0, \text{s.t. } \underline{I} - \dfrac{1}{2} \epsilon < L(f, P_0) \leq \underline{I}$。
- _Motivation：欲证只要 $|P|$ 足够小，$L(f, P), L(f, P_0)$ 就足够接近。_
- _Motivation：但 $P$ 是任意的，如何跟 $P_0$ 联系起来？能不能构造一个“中介“？_
- 将 $P, P_0$ 的合在一起（即分割点排序后去重）得到 $\tilde{P}$，则易得 $\underline{I} - \dfrac{1}{2} \epsilon < L(f, P_0) \leq L(f, \tilde{P}) \leq \underline{I}$。
- _Motivation：由于 $P_0$ 是确定的，而我们可以钦定将 $P$ 分割得“想多密有多密”，考虑将 $P_0$ 中的分割点逐个插入 $P$ 中看看？_
- 设 $P$ 表示一组 $a = x_0 < x_1 < \cdots < x_{n - 1} < x_n = b$ 的分割，令 $\forall i \in [1, n] \cap \mathbb{N}, \Delta x_i = x_i - x_{i - 1}, m_i = \displaystyle\inf_{x \in [x_{i - 1}, x_i]} f(x), M_i = \sup_{x \in [x_{i - 1}, x_i]} f(x)$。
- 设在 $P_0$ 中且不在 $P$ 中的分割点有 $k$ 个，分别为 $a < y_1 < \cdots < y_k < b$，且 $\forall i \in [1, k] \cap \mathbb{N}, y_i \in (x_{p_i - 1}, x_{p_i})$。
- 首先插入 $y_1$ 得到 $P^{(1)}$，则显然 $L(f, P^{(1)}) - L(f, P) \geq 0$，且有：

$$
\begin{aligned}
L(f, P^{(1)}) - L(f, P) &= (\inf_{x \in [x_{p_1 - 1}, y_1]} f(x) \cdot (y_1 - x_{p_1 - 1}) + \inf_{x \in [y_1, x_{p_1}]} f(x) \cdot (x_{p_1} - y_1)) - m_{y_1} \Delta x_{y_1} \\
&\leq (M_{y_1} (y_1 - x_{p_1 - 1}) + M_{y_1} (x_{p_1} - y_1)) - m_{y_1} \Delta x_k \\
&= (M_{y_1} - m_{y_1}) \Delta x_{y_1} \\
&\leq (M_{y_1} - m_{y_1}) \delta \\
&\leq (M - m) \delta
\end{aligned}
$$

- 故有 $0 \leq L(f, P^{(1)}) - L(f, P) \leq (M - m) \delta$。
- 如此续行，依次令 $i \leftarrow 2, \cdots, k$，将 $y_i$ 插入 $P^{(i - 1)}$ 中得到 $P^{(i)}$，则 $0 \leq L(f, P^{(i)}) - L(f, P^{(i - 1)}) \leq (M - m) \delta$。
- 又由于 $\tilde{P} = P^{(k)}$，将上述 $k$ 个不等式相加即得 $0 \leq L(f, \tilde{P}) - L(f, P) \leq k(M - m) \delta$。
- 取 $\delta = \dfrac{\epsilon}{2k \max(M - m, 1)}$ 即得 $L(f, P) \geq L(f, \tilde{P}) - \dfrac{1}{2} \epsilon > I - \epsilon$。
- 故 $|L(f, P) - I| < \epsilon$，遂得证。
- (2) 同 (1) 理可证。
- (3) 由 $\forall P, L(f, P) \leq U(f, P)$ 可知 $\underline{I} = \displaystyle\lim_{|P| \to 0} L(f, P) \leq \lim_{|P| \to 0} U(f, P) = \overline{I}$。

------

记上面的 $\overline{I}, \underline{I}$ 分别为 $f$ 在 $[a, b]$ 上的（Darboux）上、下积分。

可以发现，当 $\underline{I} = \overline{I}$，$f$ 在 $[a, b]$ 上一定可积；事实上，反过来也是成立的。

#### 定理（有界函数的可积条件）

内容：若 $f$ 在 $[a, b]$ 上有界，则下列命题等价：

- (1) $\forall \epsilon > 0, \exists P, \text{s.t. } U(f, P) - L(f, P) < \epsilon$。
- (2) $\underline{I} = \overline{I}$。
- (3) $\displaystyle\lim_{|P| \to 0} (U(f, P) - L(f, P)) = 0$。
- (4) $f$ 在 $[a, b]$ 上 Riemann 可积。

证明：

- $(1) \Rightarrow (2)$：由 $L(f, P) \leq \underline{I} \leq \overline{I} \leq U(f, P)$ 可知 $0 \leq \overline{I} - \underline{I} \leq U(f, P) - L(f, P)$。
- 由 $\forall \epsilon > 0, \exists P, \text{s.t. } U(f, P) - L(f, P) < \epsilon$ 可知 $\forall \epsilon > 0, 0 \leq \overline{I} - \underline{I} < \epsilon$。
- 故 $\overline{I} - \underline{I} = 0$ 即 $\underline{I} = \overline{I}$。
- $(2) \Rightarrow (3)$：由上面的定理立即可得。
- $(3) \Rightarrow (4)$：由 $\displaystyle\lim_{|P| \to 0} (U(f, P) - L(f, P)) = 0$ 可知 $\displaystyle\lim_{|P| \to 0} L(f, P) = \lim_{|P| \to 0} U(f, P)$。
- 由 $\forall P, \forall \xi, L(f, P) \leq \sigma(f, P, \xi) \leq U(f, P)$ 可知 $\displaystyle\lim_{|P| \to 0} \sigma(f, P, \xi) = \displaystyle\lim_{|P| \to 0} L(f, P) = \lim_{|P| \to 0} U(f, P)$。
- $(4) \Rightarrow (1)$：设 $I = \displaystyle\int_a^b f(x) \text{d} x$，则 $\forall \epsilon > 0, \exists \delta > 0, \text{s.t. } \forall |P| < \delta, \forall \xi, |\sigma(f, P, \xi) - I| < \dfrac{1}{3} \epsilon$。
- 对于**给定**的 $P$，由 $U(f, P), L(f, P)$ 为 $\sigma(f, P, \xi)$ 的上、下确界可知 $I - \dfrac{1}{3} \epsilon \leq L(f, P) \leq U(f, P) \leq I + \dfrac{1}{3} \epsilon$。
- 故 $U(f, P) - L(f, P) \leq (I + \dfrac{1}{3} \epsilon) - (I - \dfrac{1}{3} \epsilon) = \dfrac{2}{3} \epsilon < \epsilon$，而满足 $|P| < \delta$ 的 $P$ 显然存在，遂得证。

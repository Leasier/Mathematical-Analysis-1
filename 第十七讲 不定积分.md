# 第十七讲 不定积分

### 定义：原函数、可积与不定积分

给定在区间 $I$ 上有定义的 $f$，若 $F$ 在 $I$ 上连续，在 $I^0$ 上可导，且 $\forall x \in I^0, F'(x) = f(x)$，则称 $F$ 为 $f$ 的在 $I$ 上的一个原函数。

- 不强调区间 $I$ 时，也简称 $F$ 为 $f$ 的一个原函数。

若 $f$ 在区间 $I$ 上的原函数存在，则称 $f$ 在 $I$ 上可积。

称 $f$ 的**全部**原函数为 $f$ 的不定积分，记作 $\displaystyle\int f(x) \text{d} x$，在该式中称 $f$ 为被积函数。

#### 定理（原函数的形式）

内容：若 $F$ 为 $f$ 的一个原函数，则 $\displaystyle\int f(x) \text{d} x = F(x) + C$，这里 $C$ 表示一个常数。

证明：

- $\forall C \in \mathbb{R}, (F(x) + C)' = F'(x) = f(x)$，则 $F(x) + C$ 为 $f(x)$ 的一个原函数。
- 若 $G$ 为 $f$ 的另一个原函数，则 $(G(x) - F(x))' = G'(x) - F'(x) \equiv 0$，故 $\exists C \in \mathbb{R}, G(x) - F(x) \equiv C$，即 $G(x) = F(x) + C$。
- 综上，$\displaystyle\int f(x) \text{d} x = F(x) + C$。

------

由该定理可知，只需求出一个原函数，即可得到所有原函数。

### 不定积分表

$$
\begin{aligned}
&\int 0 \text{d} x = C &\quad &\int 1 \text{d} x = x + C \\
&\int x^{\alpha} \text{d} x = \dfrac{x^{\alpha + 1}}{\alpha + 1} + C \ (\alpha \neq -1) &\quad &\int x^{-1} \text{d} x = \ln |x| + C \\
&\int \frac{1}{x - a} \text{d} x = \ln |x - a| + C &\quad &\int e^x \text{d} x = e^x + C \\
&\int a^x \text{d} x = \frac{a^x}{\ln a} + C \ (a > 0, a \neq 1) &\quad &\int \sin x \text{d} x = -\cos x + C \\
&\int \cos x \text{d} x = \sin x + C &\quad &\int \frac{1}{\sin^2 x} \text{d} x = -\cot x + C \\
&\int \frac{1}{\cos^2 x} \text{d} x = \tan x + C &\quad &\int \frac{1}{1 + x^2} \text{d} x = \arctan x + C \\
&\int \frac{1}{\sqrt{1 - x^2}} \text{d} x = \arcsin x + C &\quad &\int \frac{1}{\sqrt{x^2 + a}} \text{d} x = \ln |x + \sqrt{x^2 + a^2}| + C \\
&\int \sinh x \text{d} x = \cosh x + C &\quad &\int \cosh x \text{d} x = \sinh x + C
\end{aligned}
$$

其中 $\sinh x = \dfrac{e^x - e^{-x}}{2}, \cosh x = \dfrac{e^x + e^{-x}}{2}$。

### 不定积分的基本性质

- (1) $\dfrac{\text{d}}{\text{d} x} \displaystyle\int f(x) \text{d} x = f(x)$，即先积分再微分不改变原函数。
- (2) $\displaystyle\int F'(x) \text{d} x = \displaystyle\int \text{d} F(x) = F(x) + C$，即先微分再积分得到与原函数相差常数的函数类。
- (3) 线性性：则：$\displaystyle\int (\alpha f(x) + \beta g(x)) \text{d} x = \alpha \int f(x) \text{d} x + \beta \int g(x) \text{d} x + C$。

[例 1] 求 $\displaystyle\int \tan^2 x \text{d} x$。

$$
\begin{aligned}
\int \tan^2 x \text{d} x &= \int \frac{\sin^2 x}{\cos^2 x} \text{d} x \\
&= \int \frac{1}{\cos^2 x} \text{d} x - \int 1 \cdot \text{d} x \\
&= \tan x - x + C
\end{aligned}
$$

[例 2] 求 $\displaystyle\int \frac{1}{x^4 - 1} \text{d} x$。

$$
\begin{aligned}
\frac{1}{x^4 - 1} \text{d} x &= \frac{1}{2} \int \frac{1}{x^2 - 1} \text{d} x - \frac{1}{2} \int \frac{1}{x^2 + 1} \text{d} x \\
&= \frac{1}{4} \int \frac{1}{x - 1} \text{d} x - \frac{1}{4} \int \frac{1}{x + 1} \text{d} x - \frac{1}{2} \int \frac{1}{x^2 + 1} \text{d} x \\
&= \frac{1}{4} \ln |x - 1| - \frac{1}{4} \ln |x + 1| - \frac{1}{2} \arctan x + C
\end{aligned}
$$

### 重要的积分方法

#### 第一换元法：逆用复合函数求导

若 $F$ 为 $f$ 的原函数，则 $F(u(x))' = f(u(x)) u'(x)$，故有：

$$
\int f(u(x)) u'(x) \text{d} x = F(u(x)) + C
$$

- 若将 $\text{d} x$ 视作微分算子，则 $f(u(x)) u'(x) \text{d} x = f(u) \text{d} u$，这样理解的话就更显然了。

[例 3] 求 $\displaystyle\int \frac{x}{1 + x^2} \text{d} x$。

$$
\begin{aligned}
\int \frac{x}{1 + x^2} \text{d} x &= \frac{1}{2} \int \frac{1}{1 + x^2} \text{d} (x^2) \\
&= \frac{1}{2} \int \frac{1}{1 + u} \text{d} u &\quad (u = x^2) \\
&= \frac{1}{2} \ln |1 + u| + C \\
&= \frac{1}{2} \ln (1 + x^2) + C
\end{aligned}
$$

[例 4] 求 $\displaystyle\int \frac{1}{a^2 + x^2} \text{d} x$。

$$
\begin{aligned}
\int \frac{1}{a^2 + x^2} \text{d} x &= \frac{1}{a^2} \int \frac{1}{1 + (\frac{x}{a})^2} \text{d} x \\
&= \frac{1}{a} \int \frac{1}{1 + (\frac{x}{a})^2} \text{d} (\frac{x}{a}) \\
&= \frac{1}{a} \int \frac{1}{1 + u^2} \text{d} u &\quad (u = \frac{x}{a}) \\
&= \frac{1}{a} \arctan u + C \\
&= \frac{1}{a} \arctan \frac{x}{a} + C
\end{aligned}
$$

[例 5] 求 $\displaystyle\int \frac{1}{\sqrt{x(1 - x)}} \text{d} x$。

法一：

- _Motivation：要是把 $x, 1 - x$ 这对“双变量”变成单变量是不是就好了？比如说，配方？_

$$
\begin{aligned}
\int \frac{1}{\sqrt{x(1 - x)}} \text{d} x &= \int \frac{1}{\sqrt{\frac{1}{4} - (x - \frac{1}{2})^2}} \text{d} x \\
&= 2 \int \frac{1}{\sqrt{1 - (2x - 1)^2}} \text{d} x \\
&= \int \frac{1}{\sqrt{1 - (2x - 1)^2}} \text{d} (2x - 1) \\
&= \int \frac{1}{\sqrt{1 - u^2}} \text{d} u &\quad (u = 2x - 1) \\
&= \arcsin u + C \\
&= \arcsin (2x - 1) + C
\end{aligned}
$$

法二：

- _Motivation：诶，这个 $\dfrac{1}{\sqrt{x}}$ 是不是能跟 $\text{d} x$ 放一起？_

$$
\begin{aligned}
\int \frac{1}{\sqrt{x(1 - x)}} \text{d} x &= \int \frac{1}{\sqrt{1 - x}} \cdot \frac{\text{d} x}{\sqrt{x}} \\
&= 2 \int \frac{1}{\sqrt{1 - x}} \text{d} (\sqrt{x}) \\
&= 2 \int \frac{1}{\sqrt{1 - u^2}} \text{d} u &\quad (u = \sqrt{x}) \\
&= 2 \arcsin u + C \\
&= 2 \arcsin \sqrt{x} + C
\end{aligned}
$$

------

有趣的是，上面两种方法给出的答案并不一致，原因在于 $\sin$ 的**二倍角公式**：

$$
\sin (2 \arcsin \sqrt{x}) = 1 - 2 \sin^2 (\arcsin \sqrt{x}) = 1 - 2x \Rightarrow 2 \arcsin \sqrt{x} = \arcsin (1 - 2x)
$$

[例 6] 求 $\{I_n\}$ 的迭代式，其中 $I_n = \displaystyle\int \tan^n x \text{d} x$。

首先有 $I_0 = x + C$，接下来计算 $I_1$：

$$
\begin{aligned}
I_1 &= \int \tan x \text{d} x \\
&= \int \frac{\sin x}{\cos x} \text{d} x \\
&= -\int \frac{1}{\cos x} \text{d} (\cos x) \\
&= -\ln |\cos x| + C
\end{aligned}
$$

接下来仿照例 1 中对线性性的运用迭代出 $n \geq 2$ 时的 $I_n$：

$$
\begin{aligned}
I_n &= \int \tan^n x \text{d} x \\
&= \int \tan^{n - 2} x (\frac{1}{\cos^2 x} - 1) \text{d} x \\
&= \int \tan^{n - 2} x \cdot \frac{1}{\cos^2 x} \cdot \text{d} x - \int \tan^{n - 2} x \text{d} x \\
&= \int \tan^{n - 2} x \text{d} (\tan x) - I_{n - 2} \\
&= \frac{\tan^{n - 1} x}{n - 1} - I_{n - 2}
\end{aligned}
$$

故可通过 $I_0$ 推出所有 $n$ 为偶数的 $I_n$、通过 $I_1$ 推出所有 $n$ 为奇数的 $I_n$。

[例 7] 求 $\displaystyle\int \frac{1}{1 + \cos^2 x} \text{d} x$。

- _Motivation：已知 $\dfrac{1}{\cos^2 x} \text{d} x = \text{d} (\tan x)$，能不能尝试提出分母里的 $\cos^2 x$？_

$$
\begin{aligned}
\int \frac{1}{1 + \cos^2 x} \text{d} x &= \int \frac{1}{\frac{1}{\cos^2 x} + 1} \cdot \dfrac{1}{\cos^2 x} \cdot \text{d} x \\
&= \int \frac{1}{\tan^2 x + 2} \text{d} (\tan x) \\
&= \frac{1}{\sqrt{2}} \int \frac{1}{(\frac{\tan x}{\sqrt{2}})^2 + 1} \text{d} (\frac{\tan x}{\sqrt{2}}) \\
&= \frac{1}{\sqrt{2}} \arcsin (\frac{\tan x}{\sqrt{2}}) + C
\end{aligned}
$$

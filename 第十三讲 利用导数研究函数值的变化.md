# 第十三讲 利用导数研究函数值的变化

### 极值与最值

#### 内点

设 $f$ 在 $I$ 上有定义，若 $\exists U(x_0), \text{s.t. } U(x_0) \subseteq I$，则称 $x_0$ 为 $I$ 的一个内点。

#### 无穷小增量公式

若 $f$ 在 $x_0$ 处可导，则 $f(x_0 + \Delta x) - f(x_0) = f'(x_0) \Delta x + o(\Delta x) \ (\Delta x \to 0)$。

由此可知：当 $f'(x_0) \neq 0$，有 $\exists \delta > 0, \text{s.t. } \forall |\Delta x| < \delta, |o(\Delta x)| < |f'(x_0)| \Delta x$，则在 $U(x_0, \delta)$ 中，$f'(x_0) \Delta x + o(\Delta x)$ 的**符号**完全由 $f'(x_0) \Delta x$ 决定。

展开写的话就是：

- 若 $f'(x_0) > 0$，则 $\forall \Delta x \in (0, \delta), f(x_0 + \Delta x) > f(x_0)$，$\forall \Delta x \in (-\delta, 0), f(x_0 + \Delta x) < f(x_0)$。
- 若 $f'(x_0) < 0$，则 $\forall \Delta x \in (0, \delta), f(x_0 + \Delta x) < f(x_0)$，$\forall \Delta x \in (-\delta, 0), f(x_0 + \Delta x) > f(x_0)$。
- **注意：这里并不能推出 $f$ 在 $x_0$ 邻域上的单调性！**

#### 极值点

对于 $I$ 的内点 $x_0$，若 $\exists \check{U}(x_0), \text{s.t. } \forall x \in \check{U}(x_0), f(x) \leq f(x_0)$，则称 $f$ 在 $x_0$ 处取得极大值，$x_0$ 点称为 $f$ 的一个极大值点。同理可以定义极小值点，两者合称极值点。

由上一部分可知：若 $f'(x_0) \neq 0$，则 $x_0$ 必不为极值点。

若将上面定义中的不等号变为严格的，还可以定义出严格极大值点和严格极小值点。

------

尽管“导数为零”和“是极值点”并没有直接的因果关联，但不难发现前者的重要性，因此不妨给这样的 $x_0$ 一个名字。

#### 临界点

若 $f$ 在 $x_0$ 处可导，且 $f'(x_0) = 0$，则称 $x_0$ 为 $f$ 的一个临界点。

#### 费马定理（极值点候选范围）

条件：

- (1) $f$ 在区间 $I$ 上有定义，$x_0$ 是 $I$ 的一个内点。
- (2) $f$ 在 $x_0$ 处可导。

结论：$x_0$ 为 $f$ 的一个极值点 $\Rightarrow x_0$ 为 $f$ 的一个临界点。

证明：若非临界点，则邻域内既有比它大的、也有比它小的，故不可能为极值点。

#### 定理（最值点候选范围）

条件：

- (1) $f$ 在 $[a, b]$ 上连续，在 $(a, b)$ 上可导；
- (2) $f$ 在 $(a, b)$ 上的临界点有 $x_1, \cdots, x_n$。

结论：

- (1) $\displaystyle\max_{x \in [a, b]} f(x) = \max \{f(a), f(b), f(x_1), \cdots, f(x_n)\}$。
- (2) $\displaystyle\min_{x \in [a, b]} f(x) = \min \{f(a), f(b), f(x_1), \cdots, f(x_n)\}$。

证明：

- 连续函数在闭区间上取得到最值。
- 除边界点外，若非临界点，则邻域内既有比它大的、也有比它小的，故不可能为最值点。
- 故最值点只可能是边界点或临界点。

### 利用导数估计函数值的变化

#### 罗尔 Rolle 定理

条件：

- (1) $f$ 在 $[a, b]$ 上连续，在 $(a, b)$ 上可导；
- (2) $f(a) = f(b)$。

结论：$\exists \xi \in (a, b), \text{s.t. } f'(\xi) = 0$。

- 几何直观：“平口函数”。
- **注意：如果没有“可导”，这样的 $\xi$ 可能不存在，如 $\land$ 形折线。**

证明：

- 由 $f$ 在 $[a, b]$ 上连续可知最大值和最小值存在。
- 由于 $f(a) = f(b)$，要么 $f$ 在 $[a, b]$ 上为常函数，要么有一个最值在**内点**取得。
- 若为前者，$\forall x \in (a, b), f'(x) = 0$，故任取 $(a, b)$ 中数皆可；若为后者，设该最值点为 $\xi \in (a, b)$，其显然也为极值点，由 $f$ 在 $(a, b)$ 上可导和费马定理知 $f'(\xi) = 0$。
- 综上，满足题意的 $\xi$ 存在。

#### 拉格朗日定理

条件：$f$ 在 $[a, b]$ 上连续，在 $(a, b)$ 上可导；

结论：$\exists \xi \in (a, b), \text{s.t. } f'(\xi) = \dfrac{f(b) - f(a)}{b - a}$。

- “定比分点”式的等价表述：$\exists \theta \in (0, 1), \text{s.t. } f'(\theta a + (1 - \theta) b) = \dfrac{f(b) - f(a)}{b - a}$。

证明：

- _Motivation：化归到罗尔定理的情况。_
- 令 $g(x) = f(x) - \dfrac{f(b) - f(a)}{b - a} \cdot (x - a)$，则 $g \in C[a, b]$ 在 $(a, b)$ 上可导，且 $\forall x \in (a, b), g'(x) = f'(x) - \dfrac{f(b) - f(a)}{b - a}$。
- 由**罗尔定理**可知 $\exists \xi \in (a, b), \text{s.t. } g'(\xi) = 0 \Leftrightarrow f'(\xi) = \dfrac{f(b) - f(a)}{b - a}$，故满足题意的 $\xi$ 存在。

这个结论也可以改写为 $\exists \xi \in (a, b), \text{s.t. } f(b) = f(a) + f'(\xi) (b - a)$，该式又称有限增量公式。

#### 定理（区间上常函数的判定）

条件：$f$ 在区间 $I$ 上连续，在 $I^0$ 上可导。

- 这里 $I^0$ 表示 $I$ 去掉（如果有的话）端点的情况，即 $I^0 = \{x \mid x \in I, \check{U}^+(x) \cap I \neq \emptyset, \check{U}^-(x) \cap I \neq \emptyset\}$，

结论：$\forall x \in I^0, f'(x) = 0 \Leftrightarrow f$ 在 $I$ 上为常值函数。

证明：

- $\Leftarrow$ 显然，下证 $\Rightarrow$。
- $\forall x_1, x_2 \in I \land x_1 < x_2$，$\exists \xi \in (x_1, x_2), \text{s.t. } f'(\xi) = \dfrac{f(x_2) - f(x_1)}{x_2 - x_1}$。
- 由 $f'(\xi) = 0$，可得 $f(x_1) = f(x_2)$。
- 由 $x_1, x_2$ 的任意性，可得 $f$ 在 $I$ 上为常函数。

推论：

- (1) $f, g$ 在区间 $I$ 上连续，在 $I^0$ 上可导，则 $\forall x \in I^0, f'(x) = g'(x) \Leftrightarrow \exists c \in \mathbb{R}, \text{s.t. } \forall x \in I, f(x) = g(x) + c$。
- (2) $f$ 在区间 $I$ 上连续，在 $I^0$ 上可导，则 $\forall x \in I^0, f^{(n + 1)}(x) = 0 \Leftrightarrow \exists a_0, a_1, \cdots, a_n \in \mathbb{R}, \text{s.t. } \forall x \in I, f(x) = \displaystyle\sum_{i = 0}^n a_i x^i$。

#### 定理（导数与函数的增减性 I）

条件：$f$ 在区间 $I$ 上可导。

结论：

- (1) $\forall x \in I, f'(x) \geq 0 \Leftrightarrow f$ 在 $I$ 上单调递增，$\forall x \in I, f'(x) \leq 0 \Leftrightarrow f$ 在 $I$ 上单调递减。
- (2) $\forall x \in I, f'(x) > 0 \Rightarrow f$ 在 $I$ 上**严格**单调递增，$\forall x \in I, f'(x) < 0 \Leftrightarrow f$ 在 $I$ 上**严格**单调递减。
- **注意：(2) 反过来未必成立，如 $f(x) = x^3$。**

证明：利用有限增量公式即可，略。

#### 定理（导数与函数的增减性 II）

条件：$f$ 在 $I$ 上可导。

结论：$f$ 在 $I$ 上**严格**单调递增 / 减 $\Leftrightarrow \forall x \in I, f'(x) \geq / \leq 0$ 且 $f'$ 不在 $I$ 的任意**开**子区间上恒为零。

- 这里强调“开”是为了排除 $[c, c] = \{c\}$ 这样的单点集。

证明（以递增为例）：

- $\Rightarrow$：由单调递增可知 $\forall x \in I, f'(x) \geq 0$。
- 另一结论则考虑反证法，假设 $f'$ 在开子区间 $J \subseteq I$ 上恒为零，则 $\forall x_1, x_2 \in J \land x_1 < x_2, \exists \xi \in (x_1, x_2), \text{s.t. } f(x_2) = f(x_1) + f'(\xi) (x_2 - x_1) = f(x_1)$，与 $f$ 在 $I$ 上严格单调递增矛盾。
- 故 $f'$ 不在 $I$ 的任意开子区间上恒为零，遂得证。
- $\Leftarrow$：由 $\forall x \in I, f'(x) \geq 0$ 可知单调递增。
- 严格性则考虑反证法，假设 $\exists x_1, x_2 \in I \land x_1 < x_2, \text{s.t. } f(x_1) \geq f(x_2)$。
- (1) $f(x_1) > f(x_2)$ 可据单调递增直接排除；
- (2) 若 $f(x_1) = f(x_2)$，则 $\forall x \in (x_1, x_2), f(x_1) \leq f(x) \leq f(x_2) \Rightarrow f(x) = f(x_1) = f(x_2)$，于是 $f$ 在 $[x_1, x_2]$ 上为常函数，故 $f'$ 在 $(x_1, x_2) \subset I$ 上恒为零，矛盾。
- 故假设不成立，即 $\forall x_1, x_2 \in I \land x_1 < x_2, \text{s.t. } f(x_1) < f(x_2)$，故 $f$ 在 $I$ 上严格单调递增。

[例 1] 求证：$\forall x \geq 0, \dfrac{x}{1 + x} \leq \ln (1 + x) \leq x$。

构造 $f(x) = \ln (1 + x) - \dfrac{x}{1 + x}$，则：

- $f(0) = 0$。
- $f'(x) = \dfrac{x}{(1 + x)^2} \Rightarrow \forall x > 0, f'(x) > 0$。

故 $\forall a > 0, f$ 在 $[0, a]$ 上**严格**单调递增，则 $f$ 在 $[0, +\infty)$ 上**严格**单调递增。

于是 $\forall x > 0, f(x) > f(0) = 0 \Leftrightarrow \dfrac{x}{1 + x} < \ln (1 + x)$。因此 $\forall x \geq 0, \dfrac{x}{1 + x} \leq \ln (1 + x)$，当且仅当 $x = 0$ 时取等。

类似地，可证 $\forall x \geq 0, \ln (1 + x) \leq x$，当且仅当 $x = 0$ 时取等。把两个不等式拼起来即可得证。

[例 2] 求证：由 $x_n = (1 + \dfrac{1}{n})^{n + 1}$ 确定的序列 $\{x_n\}$ 单调递减。

- _Motivation：$\{f(n)\}$ 单调递减 $\Leftarrow f(x)$ 单调递减。_
- **注意：对于一般的 $f$，反过来未必成立！**

令 $f(x) = (1 + \dfrac{1}{x})^{x + 1}$，考虑对数求导法：

- $\ln f(x) = (x + 1) \ln (1 + \dfrac{1}{x}) = (x + 1) \ln (x + 1) - (x + 1) \ln x$。
- $\dfrac{f'(x)}{f(x)} = (\ln (x + 1) + 1) - (\ln x + \dfrac{x + 1}{x}) = \ln (1 + \dfrac{1}{x}) - \dfrac{1}{x}$。
- 故 $f'(x) = (\ln (1 + \dfrac{1}{x}) - \dfrac{1}{x}) (1 + \dfrac{1}{x})^{x + 1}$。

$\forall x > 0, \dfrac{1}{x} > 0$，则代入例 1 中的不等式可得 $\ln (1 + \dfrac{1}{x}) < \dfrac{1}{x} \Rightarrow f'(x) < 0$。

故 $\forall a > 0, f$ 在 $[1, a]$ 上**严格**单调递减，则 $f$ 在 $[1, +\infty)$ 上**严格**单调递减。

于是 $\forall n \in \mathbb{N}_+, x_n = f(n) > f(n + 1) = x_{n + 1}$，故 $\{x_n\}$ 单调递减。

#### 反例：为什么 $f'(x_0) > / < 0$ 不能推出 $\exists U(x_0), \text{s.t. } f$ 在 $U(x_0)$ 上单调递增 / 减？

- _Motivation：要使 $f'(x)$ 在 $x_0$ 不连续。_

构造 $f(x) = \begin{cases} 0, &\quad x = 0 \\ x + 2 x^2 \sin \dfrac{1}{x}, &\quad x \neq 0 \end{cases}$，则：

- $f'(0) = \displaystyle\lim_{x \to 0} \frac{x + 2 x^2 \sin \frac{1}{x}}{x} = \lim_{x \to 0} (1 + 2x \sin \frac{1}{x}) = 1 > 0$。
- 取 $n \in \mathbb{N}_+$，则 $f(\dfrac{1}{2n \pi - \frac{\pi}{2}}) = \dfrac{1}{2n \pi - \frac{\pi}{2}} (1 - \dfrac{2}{2n \pi - \frac{\pi}{2}}), f(\dfrac{1}{2n \pi + \frac{\pi}{2}}) = \dfrac{1}{2n \pi + \frac{\pi}{2}} (1 + \dfrac{2}{2n \pi + \frac{\pi}{2}})$。

经计算得 $f(\dfrac{1}{2n \pi - \frac{\pi}{2}}) - f(\dfrac{1}{2n \pi + \frac{\pi}{2}}) < 0$。于是对于任意的 $U(x_0)$，只需取足够大的 $n$，即可说明 $f$ 在 $U(x_0)$ 上不单调递增。

-  当然，也可以直接利用 $f'(x)$ 在 $0$ 处不连续来说明。

#### 定理（临界点存在性）

内容：$f$ 在 $[a, b]$ 上可导，若 $f'_+(a) f'_-(b) < 0$，则 $\exists \xi \in (a, b), \text{s.t. } f'(\xi) = 0$。

- **注意：如果直接用介值定理处理，则还要求 $f'$ 在 $(a, b)$ 上连续，这里却去除了这一限制。**

证明：

- 不妨设 $f'_+(a) > 0, f'_-(b) < 0$。
- 则由无穷小增量公式可知 $\exists x_1 \in \check{U}^+(a), \text{s.t. } f(x_1) > f(a)$ 且 $\exists x_2 \in \check{U}^-(b), \text{s.t. } f(x_2) > f(b)$。
- 由于 $f$ 在 $[a, b]$ 上可导，可知 $f$ 在 $[a, b]$ 上连续，进而 $f$ 能在 $[a, b]$ 上取到最大值点 $\xi$。
- 由 $f(x_1) > f(a), f(x_2) > f(b)$ 可知 $\xi \neq a, b$，即 $x_0 \in (a, b)$。
- 由 $\xi$ 也为极大值点，可知 $f'(\xi) = 0$，故满足题意的 $\xi$ 存在。

#### 达布 Darboux 定理

内容：$f$ 在 $[a, b]$ 上可导，$\forall \eta$ 在 $f'_+(a), f'_-(b)$ 之间，则 $\exists \xi \in [a, b], \text{s.t. } f'(\xi) = \eta$。（若 $\xi$ 为端点则取单侧导数。）

证明：

- 若 $\eta = f'_+(a)$ 或 $\eta = f'_-(b)$，则取 $\eta = a$ 或 $\eta = b$ 即可。
- 不妨设 $f'_+(a) \leq f'_-(b)$，若 $f'_+(a) < \eta < f'_-(b)$，令 $g(x) = f(x) - \eta x$，有 $g'(x) = f'(x) - \eta$。
- 于是 $\exists \xi \in [a, b], \text{s.t. } g'(\xi) = 0 \Rightarrow f'(\xi) = \eta$，故满足题意的 $\xi$ 存在。

------

该定理给出了一个有趣的性质：对于一个函数的导函数而言，即便它不连续，也一定具有介值性。

下面讨论导函数在定义域内某点 $x_0$ 的连续性：

- 可去间断点：令 $t = \displaystyle\lim_{x \to x_0} f(x), \epsilon_0 = \dfrac{|t - f(x_0)|}{2}$，则 $\exists \delta_0 > 0, \text{s.t. } \forall x \in \check{U}(x_0, \delta_0), |f(x) - f(x_0)| < \epsilon_0 \Rightarrow |f(x) - f(x_0)| > \epsilon_0$。令 $\delta = \dfrac{\delta_0}{2}, \eta_0 = \dfrac{t + f(x_0)}{2}$，则 $\not\exists x \in [x_0, x_0 + \delta], \text{s.t. } f(x) = \eta_0 \in [\eta_0, f(x)] \subset [f(x_0), f(x)]$，与达布定理矛盾。故不存在可去间断点。
- 同理可证不存在跳跃间断点。

至此我们排除了第一类间断点的存在性，同时易知第二类间断点中一侧发散于无穷的情况不存在。

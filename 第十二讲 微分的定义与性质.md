# 第十二讲 微分的定义与性质

### 可微

#### 定义

若 $f$ 在 $U(x_0)$ 上有定义，且 $\exists A \in \mathbb{R}, \text{s.t. } f(x) - f(x_0) = A(x - x_0) + o(x - x_0) \ (x \to x_0)$，则称 $f$ 在 $x_0$ 处可微。

- **注意：这里的 $A$ 不应被 $x$ 确定！**

#### 与可导的关系

##### 在 $\mathbb{R}$ 上，可导 $\Leftrightarrow$ 可微

当 $f$ 在 $x_0$ 处可导，有 $\displaystyle\lim_{x \to x_0} \frac{f(x) - f(x_0)}{x - x_0} = f'(x_0)$，则 $\displaystyle\lim_{x \to x_0} (\frac{f(x) - f(x_0)}{x - x_0} - f'(x_0)) = 0$，即 $\dfrac{f(x) - f(x_0)}{x - x_0} - f'(x_0) = o(1) \ (x \to x_0)$，则 $f(x) - f(x_0) = f'(x_0) (x - x_0) + o(x - x_0) \ (x \to x_0)$。

反过来也是一样的，不再赘述。

##### 在 $\mathbb{R}^n$ 上 / 多元函数

考虑 $f : \mathbb{R}^n \to \mathbb{R}$，若代入导数的定义则发现其具有“数除以向量”的形式，这是未定义的。故此时不可导。

但此时可能是可微的，即 $\exists \mathbf{a} \in \mathbb{R}^n, \text{s.t. } f(\mathbf{x}) - f(\mathbf{x}_0) = \mathbf{a}^T (\mathbf{x} - \mathbf{x}_0) + o(||\mathbf{x} - \mathbf{x}_0||) \ (\mathbf{x} \to \mathbf{x}_0)$ 可能成立，其中 $||\mathbf{x} - \mathbf{x}_0||$ 表示 $\mathbf{x} - \mathbf{x}_0$ 的范数，表征了两者间的距离。

------

不过在本学期，我们只会讨论 $\mathbb{R}$ 上的情况，因此暂时可以认为可导 $\Leftrightarrow$ 可微。

### 微分的含义

设 $\Delta y = f(x + \Delta x) - f(x)$，若 $f$ 在 $x$ 处可导，则 $\Delta y = f'(x) \Delta x + o(\Delta x) \ (x \to x_0)$。

- $\Delta x, \Delta y$ 分别表示 $x, y$ 的增量。
- $f'(x) \Delta x$ 称为 $\Delta y$ 的主部，也称为 $y$ 的**微分**，记作 $\text{d} y$ 或 $\text{d} f(x)$。
- $\Delta x$ 记作 $\text{d} x$，因此可微函数的微分常记作 $\text{d} y = f'(x) \text{d} x$。

### 微分的形式不变性

#### 对一阶微分成立

考虑函数 $y = f(x), x = g(t)$：

- $x$ 为自变量：$y = f(x) \Rightarrow \text{d} y = f'(x) \text{d} x$。
- $t$ 为自变量：$x = g(t) \Rightarrow \text{d} x = g'(t) \text{d} t$。
- $x$ 为中间变量：$y = f(g(t)) \Rightarrow \text{d} y = f'(g(t)) g'(t) \text{d} t$。

我们注意到，无论 $x$ 是自变量还是中间变量，都有 $\text{d} y = f'(x) \text{d} x$。

这一性质称为**一阶微分的形式不变性**。

#### 对高阶微分不总成立

先引入二阶微分的记号并根据定义进行计算 $x$ 为自变量的情况：

- 由于 $\text{d} y = f'(x) \text{d} x$ 中 $\text{d} x$ 与 $x$ **无关**，我们仍可以将其视为**关于 $x$ 的函数**。
- 若 $\text{d} y$ 这一“函数”在 $x$ 处可微，我们可以计算其一阶微分，也称为 $y = f(x)$ 的二阶微分。
- 具体地，取自变量的改变量与原来的改变量 $\text{d} x$ **相同**，可得：

$$
\begin{aligned}
\text{d}^2 y &\equiv \text{d} (\text{d} y) \\
&= (f'(x) \text{d} x)_x' \text{d} x \\
&= (f''(x) \text{d} x) \text{d} x \\
&= f''(x) (\text{d} x)^2 \\
&\equiv f''(x) \text{d} x^2
\end{aligned}
$$

仍考虑函数 $y = f(x), x = g(t)$，接下来计算 $x$ 为中间变量的情况：

$$
\begin{aligned}
\text{d}^2 y &= (f'(x) \text{d} x)_t' \text{d} t \\
&= ((f'(x))'_t \text{d} x + f'(x) (\text{d} x)_t') \text{d} t \\
&= ((f'(g(t)))'_t \text{d} x + f'(x) (g'(t) \text{d} t)_t') \text{d} t \\
&= (f''(g(t)) g'(t) \cdot \text{d} x + f'(x) \cdot g''(t) \text{d} t) \text{d} t \\
&= f''(x) \text{d} x^2 + f'(x) \text{d}^2 x
\end{aligned}
$$

可以发现，此时 $\text{d}^2 y$ 不总等于 $f''(x) \text{d} x^2$，因为还有一项 $f'(x) \text{d}^2 x$。

特别地，当 $f'(x) = 0$ 或 $\text{d}^2 x = 0$（比如 $g(t)$ 为线性函数）时，形式不变性仍成立。

------

一般地，对高阶微分而言：

- $x$ 为自变量：不难归纳出 $\text{d}^n y = f^{(n)}(x) \text{d} x^n$。
- $x$ 为中间变量：上式不总成立。

### 导数公式的微分形式

#### 四则运算

- $\text{d} (f \pm g) = \text{d} f \pm \text{d} g$。
- $\text{d} (fg) = \text{d} f \cdot g + f \cdot \text{d} g$。
- $\text{d} (\dfrac{f}{g}) = \dfrac{g \text{d} f - f \text{d} g}{g^2}$。

[例 1] 利用微分的运算性质，推导 $\dfrac{\text{d}^2 x}{\text{d} y^2}, \dfrac{\text{d}^3 x}{\text{d} y^3}$ 用 $y' = \dfrac{\text{d} y}{\text{d} x}, y'' = \dfrac{\text{d}^2 y}{\text{d} x^2}, y''' = \dfrac{\text{d}^3 y}{\text{d} x^3}$ 表达的形式。

- _Motivation：$y', y'', y'''$ 都是以 $x$ 为自变量的微分。_

考虑利用 $\dfrac{\text{d} x}{\text{d} y} = \dfrac{1}{y'} \Rightarrow \dfrac{1}{\text{d} y} = \dfrac{1}{y' \text{d} x}$，首先计算 $\dfrac{\text{d}^2 x}{\text{d} y^2}$：

$$
\begin{aligned}
\dfrac{\text{d}^2 x}{\text{d} y^2} &= \dfrac{\text{d}}{\text{d} y} (\dfrac{\text{d} x}{\text{d} y}) \\
&= \dfrac{1}{y'} \cdot \dfrac{\text{d}}{\text{d} x} (\dfrac{1}{y'}) \\
&= \dfrac{1}{y'} \cdot -\dfrac{y''}{(y')^2} \\
&= -\dfrac{y''}{(y')^3} \\
\end{aligned}
$$

接着计算 $\dfrac{\text{d}^3 x}{\text{d} y^3}$：

$$
\begin{aligned}
\dfrac{\text{d}^3 x}{\text{d} y^3} &= \dfrac{\text{d}}{\text{d} y} (\dfrac{\text{d}^2 x}{\text{d} y^2}) \\
&= \dfrac{1}{y'} \cdot \dfrac{\text{d}}{\text{d} x} (-\dfrac{y''}{(y')^3}) \\
&= -\dfrac{1}{y'} \cdot \dfrac{(y')^3 y''' - 3 (y')^2 y'' \cdot y''}{(y')^6} \\
&= \dfrac{3 (y'')^2 - y' y'''}{(y')^5} \\
\end{aligned}
$$

#### 若干性质的直观阐述

- $y = f(x), x = g(t)$：$\dfrac{\text{d} y}{\text{d} t} = \dfrac{\text{d} y}{\text{d} x} \cdot \dfrac{\text{d} x}{\text{d} t}$。
- $y = f(x), x = g(y)$：$\dfrac{\text{d} x}{\text{d} y} = \dfrac{1}{\frac{\text{d} y}{\text{d} x}}$。
- $y = f(t), x = g(t)$：$\dfrac{\text{d} y}{\text{d} x} = \dfrac{\frac{\text{d} y}{\text{d} t}}{\frac{\text{d} x}{\text{d} t}}$。
- **注意：微分记号隐去了法则适用的条件和分母为零等问题，不能当作证明！**

#### 微分版的 Leibnitz 公式

代入导数的 Leibnitz 公式可知：$\text{d}^n (fg) = (fg)^{(n)}(x) \text{d} x^n = \displaystyle\sum_{i = 0}^n \dbinom{n}{i} \cdot \text{d}^{n - i} f \cdot \text{d}^i g$。

### 隐函数求导

- 注：下面的讨论只涉及一阶微分，故可不区分自变量与中间变量。

#### 类型 1：$f(x) g(y) = C$

$$
\begin{aligned}
&\text{d} (f(x) g(y)) = \text{d} C \\
\Leftrightarrow &\text{d} f(x) \cdot g(y) + f(x) \cdot \text{d} g(y) = 0 \\
\Leftrightarrow &f(x) g'(y) \text{d} y = -f'(x) g(y) \text{d} x \\
\Leftrightarrow &\dfrac{\text{d} y}{\text{d} x} = -\dfrac{f'(x) g(y)}{f(x) g'(y)}
\end{aligned}
$$

#### 类型 2：$f(x) + g(y) = C$

$$
\begin{aligned}
&\text{d} (f(x) + g(y)) = \text{d} C \\
\Leftrightarrow &\text{d} f(x) + \text{d} g(y) = 0 \\
\Leftrightarrow &g'(y) \text{d} y = -f'(x) \text{d} x \\
\Leftrightarrow &\dfrac{\text{d} y}{\text{d} x} = -\dfrac{f'(x)}{g'(y)}
\end{aligned}
$$

------

[例 2] 已知 $y = y(x)$ 存在反函数，且满足方程 $\dfrac{\text{d}^2 y}{\text{d} x^2} + (\dfrac{\text{d} y}{\text{d} x})^3 = 0$，求证：其反函数 $x = x(y)$ 满足 $\dfrac{\text{d}^2 x}{\text{d} y^2} = 1$。

法一：通过导数形式

- 设 $y = y(x)$ 在 $D$ 上可导且值域为 $y(D)$，则：

$$
\begin{aligned}
\forall t \in y(D), \ & y(x(t)) = t &\quad \\
\Rightarrow \ & y'(x(t)) \cdot x'(t) = 1 &\quad (1) \\
\Rightarrow \ & y''(x(t)) \cdot (x'(t))^2 + y'(x(t)) \cdot x''(t) = 0 &\quad (2)
\end{aligned}
$$

- 由题给条件可知 $y''(x(t)) = -(y'(x(t)))^3$。
- 由 $(1)$ 可知 $x'(t) = \dfrac{1}{y'(x(t))}$，且 $x'(t), y'(x(t)) \neq 0$。
- 将上面两式代入 $(2)$ 可知 $-(y'(x(t)))^3 \cdot (\dfrac{1}{y'(x(t))})^2 + y'(x(t)) \cdot x''(t) = 0$。
- 化简得 $y'(x(t)) (x''(t) - 1) = 0$，由 $y'(x(t)) \neq 0$ 知 $x''(t) = 1$。
- 故以 $y$ 为自变量时，$\dfrac{\text{d}^2 x}{\text{d} y^2} = x''(y) = 1$。

法二：通过微分形式

- 设 $p = \dfrac{\text{d} y}{\text{d} x}$，则 $\dfrac{\text{d} x}{\text{d} y} = \dfrac{1}{p}$。
- 对 $y$ 求二阶导，有：

$$
\begin{aligned}
\dfrac{\text{d}^2 x}{\text{d} y^2} &= \dfrac{\text{d}}{\text{d} y} (\dfrac{1}{p}) \\
&= -\dfrac{1}{p^2} \cdot \dfrac{\text{d} p}{\text{d} y} \\
&= -\dfrac{1}{p^3} \cdot \dfrac{\text{d}^2 y}{\text{d} x^2}
\end{aligned}
$$

- 由题给条件可知 $\dfrac{\text{d}^2 y}{\text{d} x^2} + p^3 = 0$，代入可知 $\dfrac{\text{d}^2 x}{\text{d} y^2} = 1$。

[例 3] 已知 $xy = -1$，求证：$\dfrac{\text{d} x}{\sqrt{1 + x^4}} = \dfrac{\text{d} y}{\sqrt{1 + y^4}}$。

$$
\begin{aligned}
& xy = -1 \\
\Rightarrow & x \text{d} y + y \text{d} x = 0 \\
\Rightarrow & \sqrt{1 + x^4} \text{d} y + \frac{\sqrt{1 + x^4}}{x} \cdot y \text{d} x = 0 \\
\Leftrightarrow & \sqrt{1 + x^4} \text{d} y + \frac{\sqrt{1 + (-\frac{1}{y})^4}}{-\frac{1}{y}} \cdot y \text{d} x = 0 \\
\Leftrightarrow & \sqrt{1 + x^4} \text{d} y - \sqrt{1 + y^4} \text{d} x = 0 \\
\Leftrightarrow & \frac{\text{d} x}{\sqrt{1 + x^4}} = \frac{\text{d} y}{\sqrt{1 + y^4}}
\end{aligned}
$$

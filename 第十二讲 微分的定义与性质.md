# 第十二讲 微分的定义与性质

### 可微

#### 定义

若 $f$ 在 $U(x_0)$ 上有定义，且 $\exists A \in \mathbb{R}, \text{s.t. } f(x) - f(x_0) = A(x - x_0) + o(x - x_0) \ (x \to x_0)$，则称 $f$ 在 $x_0$ 处可微。

- **注意：这里的 $A$ 不应被 $x$ 确定！**

#### 与可导的关系

##### 在 $\mathbb{R}$ 上，可导 $\Leftrightarrow$ 可微

当 $f$ 在 $x_0$ 处可导，有 $\displaystyle\lim_{x \to x_0} \frac{f(x) - f(x_0)}{x - x_0} = f'(x_0)$，则 $\displaystyle\lim_{x \to x_0} (\frac{f(x) - f(x_0)}{x - x_0} - f'(x_0)) = 0$，即 $\dfrac{f(x) - f(x_0)}{x - x_0} - f'(x_0) = o(1) \ (x \to x_0)$，则 $f(x) - f(x_0) = f'(x_0) (x - x_0) + o(x - x_0) \ (x \to x_0)$。

反过来也是一样的，不再赘述。

##### 在 $\mathbb{R}^n$ 上 / 多元函数

考虑 $f : \mathbb{R}^n \to \mathbb{R}$，若代入导数的定义则发现其具有“数除以向量”的形式，这是未定义的。故此时不可导。

但此时可能是可微的，即 $\exists \mathbf{A} \in \mathbb{R}^n, \text{s.t. } f(\mathbf{x}) - f(\mathbf{x}_0) = \mathbf{A}^T (\mathbf{x} - \mathbf{x}_0) + o(||\mathbf{x} - \mathbf{x}_0||) \ (\mathbf{x} \to \mathbf{x}_0)$ 可能成立，其中 $||\mathbf{x} - \mathbf{x}_0||$ 表示 $\mathbf{x} - \mathbf{x}_0$ 的范数，表征了两者间的距离。

------

不过在本学期，我们只会讨论 $\mathbb{R}$ 上的情况，因此暂时可以认为可导 $\Leftrightarrow$ 可微。

### 微分的含义

设 $\Delta y = f(x + \Delta x) - f(x)$，若 $f$ 在 $x$ 处可导，则 $\Delta y = f'(x) \Delta x + o(\Delta x) \ (x \to x_0)$。

- $\Delta x, \Delta y$ 分别表示 $x, y$ 的增量。
- $f'(x) \Delta x$ 称为 $\Delta y$ 的主部，也称为 $y$ 的**微分**，记作 $\text{d} y$ 或 $\text{d} f(x)$。
- $\Delta x$ 记作 $\text{d} x$，因此可微函数的微分常记作 $\text{d} y = f'(x) \text{d} x$。

### 微分的形式不变性

#### 对一阶微分成立

考虑函数 $y = f(x), x = g(t)$：

- $x$ 为自变量：$y = f(x) \Rightarrow \text{d} y = f'(x) \text{d} x$。
- $t$ 为自变量：$x = g(t) \Rightarrow \text{d} x = g'(t) \text{d} t$。
- $x$ 为中间变量：$y = f(g(t)) \Rightarrow \text{d} y = f'(g(t)) g'(t) \text{d} t$。

我们注意到，无论 $x$ 是自变量还是中间变量，都有 $\text{d} y = f'(x) \text{d} x$。

这一性质称为**一阶微分的形式不变性**。

#### 对高阶微分不总成立

先引入二阶微分的记号并根据定义进行计算 $x$ 为自变量的情况：

- 由于 $\text{d} y = f'(x) \text{d} x$ 中 $\text{d} x$ 与 $x$ **无关**，我们仍可以将其视为**关于 $x$ 的函数**。
- 若 $\text{d} y$ 这一“函数”在 $x$ 处可微，我们可以计算其一阶微分，也称为 $y = f(x)$ 的二阶微分。
- 具体地，取自变量的改变量与原来的改变量 $\text{d} x$ **相同**，可得：

$$
\begin{aligned}
\text{d}^2 y &\equiv \text{d} (\text{d} y) \\
&= (f'(x) \text{d} x)_x' \text{d} x \\
&= (f''(x) \text{d} x + f'(x) (\text{d} x)_x') \text{d} x \\
&= f''(x) (\text{d} x)^2 \\
&\equiv f''(x) \text{d} x^2
\end{aligned}
$$

仍考虑函数 $y = f(x), x = g(t)$，接下来计算 $x$ 为中间变量的情况：

$$
\begin{aligned}
\text{d}^2 y &= (f'(x) \text{d} x)_t' \text{d} t \\
&= ((f'(x))'_t \text{d} x + f'(x) (\text{d} x)_t') \text{d} t \\
&= (f''(x) g'(t) \cdot \text{d} x + f'(x) \cdot g''(t) \text{d} t) \text{d} t \\
&= f''(x) \text{d} x^2 + f'(x) \text{d}^2 x
\end{aligned}
$$

可以发现，此时 $\text{d}^2 y$ 不总等于 $f''(x) \text{d} x^2$，因为还有一项 $f'(x) \text{d}^2 x$。

- 当然，上式也可以展开成仅用 $t$ 表示的形式 $\text{d}^2 y = (f''(g(t)) g'(t)^2 + f'(g(t)) g''(t)) \text{d}^2 t$。
- 特别地，当 $f'(x) = 0$ 或 $\text{d}^2 x = 0$（比如 $g(t)$ 为线性函数）时，形式不变性仍成立。

------

一般地，对高阶微分而言：

- $x$ 为自变量：不难归纳出 $f^{(n)}(x) = \dfrac{\text{d}^n y}{\text{d} x^n}$。
- $x$ 为中间变量：上式不总成立。

### 导数公式的微分形式

#### 四则运算

- $\text{d} (f \pm g) = \text{d} f \pm \text{d} g$。
- $\text{d} (fg) = \text{d} f \cdot g + f \cdot \text{d} g$。
- $\text{d} (\dfrac{f}{g}) = \dfrac{g \text{d} f - f \text{d} g}{g^2}$。

------

利用乘积的微分公式，我们可以给出推导“高阶微分不总有形式不变性”的更美观的写法：

$$
\begin{aligned}
\text{d}^2 y &= \text{d} (f'(x) \text{d} x) \\
&= f''(x) \text{d} x^2 + f'(x) \text{d}^2 x
\end{aligned}
$$

即：我们将 $f'(x) \text{d} x$ 视为两项的乘积，随后可以套公式一步到位。

------

下面先出一个在 $x$ 为中间变量时，二阶微分的**错误**推导。该推导过程尝试将二阶微分转化为一阶微分处理：

$$
\begin{aligned}
\dfrac{\text{d}^2 y}{\text{d} x^2} &= \dfrac{\text{d} \frac{\text{d} y}{\text{d} x}}{\text{d} x} \\
&= \dfrac{\frac{\text{d} x \text{d}^2 y - \text{d}^2 x \text{d} y}{\text{d} x^2}}{\text{d} x} \\
&= \dfrac{\text{d}^2 y}{\text{d} x^2} - \dfrac{\text{d} y \text{d}^2 x}{\text{d} x^3}
\end{aligned}
$$

~~你说得对，但 $\dfrac{\text{d} y \text{d}^2 x}{\text{d} x^3} = 0$ 恐怕并不总是成立。但问题是什么？~~

问题在于第一个等号：$\dfrac{\text{d}^2 y}{\text{d} x^2}$ 事实上不能直接跟 $\dfrac{\text{d} \frac{\text{d} y}{\text{d} x}}{\text{d} x}$ 划等号。否则 $\text{d} \dfrac{\text{d} y}{\text{d} x} = \dfrac{\text{d}^2 y}{\text{d} x}$ 成立，而这意味着除法的微分的后一项被抛弃了。

#### 若干性质的直观阐述

- $y = f(x), x = g(t)$：$\dfrac{\text{d} y}{\text{d} t} = \dfrac{\text{d} y}{\text{d} x} \cdot \dfrac{\text{d} x}{\text{d} t}$。
- $y = f(x), x = g(y)$：$\dfrac{\text{d} x}{\text{d} y} = \dfrac{1}{\frac{\text{d} y}{\text{d} x}}$。
- $y = f(t), x = g(t)$：$\dfrac{\text{d} y}{\text{d} x} = \dfrac{\frac{\text{d} y}{\text{d} t}}{\frac{\text{d} x}{\text{d} t}}$。
- **注意：微分记号隐去了法则适用的条件和分母为零等问题，不能当作证明！**

#### 微分版的 Leibnitz 公式

代入导数的 Leibnitz 公式可知：$\text{d}^n (fg) = (fg)^{(n)}(x) \text{d} x^n = \displaystyle\sum_{i = 0}^n \dbinom{n}{i} \cdot \text{d}^{n - i} f \cdot \text{d}^i g$。

### 隐函数求导

- 注：下面的讨论只涉及一阶微分，故可不区分自变量与中间变量。

#### 类型 1：$f(x) g(y) = C$

$$
\begin{aligned}
&\text{d} (f(x) g(y)) = \text{d} C \\
\Leftrightarrow &\text{d} f(x) \cdot g(y) + f(x) \cdot \text{d} g(y) = 0 \\
\Leftrightarrow &f(x) g'(y) \text{d} y = -f'(x) g(y) \text{d} x \\
\Leftrightarrow &\dfrac{\text{d} y}{\text{d} x} = -\dfrac{f'(x) g(y)}{f(x) g'(y)}
\end{aligned}
$$

#### 类型 2：$f(x) + g(y) = C$

$$
\begin{aligned}
&\text{d} (f(x) + g(y)) = \text{d} C \\
\Leftrightarrow &\text{d} f(x) + \text{d} g(y) = 0 \\
\Leftrightarrow &g'(y) \text{d} y = -f'(x) \text{d} x \\
\Leftrightarrow &\dfrac{\text{d} y}{\text{d} x} = -\dfrac{f'(x)}{g'(y)}
\end{aligned}
$$

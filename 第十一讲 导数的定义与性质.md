# 第十一讲 导数的基本概念与性质

### 导数

#### 定义

当 $f$ 在 $U(x_0)$ 上有定义，若极限 $\displaystyle\lim_{\Delta x \to 0} \frac{f(x_0 + \Delta x) - f(x_0)}{\Delta x}$ 存在，称 $f$ 在 $x_0$ 可导，将这一极限记为 $f'(x_0)$，称为 $f$ 在 $x_0$ 的**导数**。

- 几何意义：两点无限接近时的割线斜率即为切线斜率。

类似于**单侧极限**：当 $f$ 在 $U^-(x_0)$ 上有定义，若极限 $\displaystyle\lim_{\Delta x \to 0^-} \frac{f(x_0 + \Delta x) - f(x_0)}{\Delta x}$ 存在，则称 $f$ 在 $x_0$ **左侧**可导，将这一极限记为 $f_-'(x_0)$；同理可以定义**右侧**可导与 $f_+'(x_0)$。$f'(x_0)$ 存在当且仅当 $f_-'(x_0), f_+'(x_0)$ 存在且相等。

对于闭区间 $[a, b]$，当 $\forall x \in (a, b), f$ 在 $x$ 可导，且 $f$ 在 $a$ 右侧可导、在 $b$ 左侧可导，则称 $f$ 在 $[a, b]$ 上可导。此时我们补充 $f'(a) = f_+'(a), f'(b) = f_-'(b)$，即可定义 $f$ 在 $[a, b]$ 上的**导函数** $f'(x)$。

- 注意区分导数与导函数。

------

考虑 $f_+'(x_0)$ 与 $f'(x_0^+)$。它们有何区别？

- 前者要求 $f$ 在 $x_0$ 处有定义，但不要求其在 $\check{U}^+(x_0)$ 上可导。
- 后者不要求 $f$ 在 $x_0$ 处有定义，但要求其在 $\check{U}^+(x_0)$ 上可导。

例如：考察 $f(x) = \begin{cases} 0, &\quad x = 0 \\ x^2 \sin \dfrac{1}{x}, &\quad x \neq 0 \end{cases}$。

#### 基本性质

##### 性质 1

若 $f, g$ 在 $x$ 可导，则：

- $f \pm g$ 在 $x$ 可导，且 $(f \pm g)'(x) = f'(x) + g'(x)$。
- $\forall c \in \mathbb{R}$，$cf$ 在 $x$ 可导，且 $(cf)'(x) = cf'(x)$。

由极限的四则运算易得。

##### 性质 2

内容：$f$ 在 $x_0$ 可导 $\Rightarrow f$ 在 $x_0$ 连续。

证明：

- _Motivation：凑出导数的形式。_
- $\displaystyle\lim_{x \to x_0} f(x) = \lim_{\Delta x \to 0} f(x_0 + \Delta x) = \lim_{\Delta x \to 0} (f(x_0) + \Delta x \cdot \frac{f(x_0 + \Delta x) - f(x_0)}{\Delta x}) = f(x_0) + 0 \cdot f'(x_0) = f(x_0)$。

------

事实上，可导 $\Rightarrow$ 左、右可导 $\Rightarrow$ 左、右连续 $\Leftrightarrow$ 连续。

关于第二个箭头为什么不可逆：考察 $f(x) = \begin{cases} 0, &\quad x = 0 \\ x \sin \dfrac{1}{x}, &\quad x \neq 0 \end{cases}$ 在 $0$ 处的表现。

##### 性质 3

内容：$f(x_0 + \Delta x) = f(x_0) + f'(x_0) \Delta x + o(\Delta x) \ (\Delta x \to 0)$。

证明：

- 对导数移项可知 $\displaystyle\lim_{\Delta x \to 0} (\frac{f(x_0 + \Delta x) - f(x)}{\Delta x} - f'(x_0)) = 0$。
- 因此 $\dfrac{f(x_0 + \Delta x) - f(x)}{\Delta x} - f'(x_0) = o(1) \ (\Delta x \to 0)$，整理即可得到上述结论。

##### 性质 4

内容：若 $f, g$ 在 $x$ 处可导，则：

- $fg$ 在 $x$ 处可导，且 $(fg)'(x) = f'(x) g(x) + f(x) g'(x)$。
- 若 $\exists U(x), \text{s.t. } 0 \not\in g(U(x))$，则 $\dfrac{f}{g}$ 在 $x$ 处可导，且 $(\dfrac{f}{g})'(x) = \dfrac{f'(x) g(x) - f(x) g'(x)}{g(x)^2}$。

证明：

- 乘法：$\displaystyle\lim_{\Delta x \to 0} \frac{f(x + \Delta x) g(x + \Delta x) - f(x) g(x)}{\Delta x} = \lim_{\Delta x \to 0} \frac{f(x + \Delta x) (g(x + \Delta x) - g(x)) + g(x) (f(x + \Delta x) - f(x))}{\Delta x} = \lim_{\Delta x \to 0} f(x + \Delta x) \frac{g(x + \Delta x) - g(x)}{\Delta x} + \lim_{\Delta x \to 0} g(x) \frac{f(x + \Delta x) - f(x)}{\Delta x} = f'(x) g(x) + f(x) g'(x)$。
- 除法：只需考虑 $\dfrac{1}{g(x)}$ 的导数 $\displaystyle\lim_{\Delta x \to 0} \dfrac{\frac{1}{g(x + \Delta x)} - \frac{1}{g(x)}}{\Delta x} = \lim_{\Delta x \to 0} \dfrac{1}{g(x) g(x + \Delta x)} \cdot \dfrac{g(x) - g(x + \Delta x)}{\Delta x} = -\dfrac{g'(x)}{g(x)^2}$。随后用乘法法则即可。

##### 性质 5（复合函数求导，链式法则）

内容：若 $y = f(x)$ 在 $x_0$ 处可导，$x = g(t)$ 在 $t_0$ 处可导，且 $g(t_0) = x_0$，则 $(f \circ g)'(x_0) = f'(g(x_0)) g'(x_0)$。

- Q：为什么没有显式要求复合函数求极限时提及的“去心邻域映射到去心邻域”？
- A：可导意味着连续，连续的定义意味着上面这一点，故不必赘述。

证明：

- 我们期待 $\displaystyle\lim_{\Delta x \to 0} \frac{f(g(x_0 + \Delta x)) - f(g(x_0))}{\Delta x} = \lim_{\Delta x \to 0} \frac{f(g(x_0 + \Delta x)) - f(g(x_0))}{g(x_0 + \Delta x) - g(x_0)} \cdot \frac{g(x_0 + \Delta x) - g(x_0)}{\Delta x} = f'(g(x_0)) g'(x_0)$。
- **但这样拆是不是有点问题啊？你咋知道存在一个 $x_0$ 的去心邻域，使得 $g$ 在其中都不等于 $g(x_0)$？**
- 令 $\psi(x) = \begin{cases} f'(g(x_0)), &\quad x = g(x_0) \\ \dfrac{f(x) - f(g(x_0))}{x - g(x_0)}, &\quad x \neq g(x_0) \end{cases}$，则 $\psi$ 在 $g(x_0)$ 处连续。
- 故 $\displaystyle\lim_{\Delta x \to 0} \frac{f(g(x_0 + \Delta x)) - f(g(x_0))}{\Delta x} = \lim_{\Delta x \to 0} \psi(g(x_0 + \Delta x)) \cdot \frac{g(x_0 + \Delta x) - g(x_0)}{\Delta x} = \psi(g(x_0)) g'(x_0) = f'(g(x_0)) g'(x_0)$，遂得证。

##### 性质 6（反函数求导）

内容：若 $y = f(x)$ 在定义域内严格单调且连续，在 $x_0$ 处可导且 $f'(x_0) \neq 0$，则存在反函数 $x = g(y)$，其在 $y_0 = f(x_0)$ 处可导且 $g'(y_0) = \dfrac{1}{f'(x_0)} = \dfrac{1}{f'(g'(y_0))}$。

证明：

- 法一：复合函数求导
- $f(g(y)) = y \Rightarrow f'(g(y)) \cdot g'(y) = 1$。
- 故 $g'(y_0) = \dfrac{1}{f'(g(y_0))} = \dfrac{1}{f'(x_0)}$。
- 法二：利用定义（略）
- 这里 $g$ 在定义域内严格单调且连续，则不需要像性质 5 一样处理。

##### 性质 7（参数表示的函数求导）

条件：

- (1) $x(t)$ 在 $U(t_0)$ 上单调且连续，$x(t_0) = x_0$；
- (2) $x(t), y(t)$ 在 $x_0$ 处可导；
- (3) $x'(t_0) \neq 0$。

结论：$y = f(x)$ 在 $x_0$ 处可导，且 $f'(x_0) = \dfrac{y'(t_0)}{x'(t_0)}$。

证明略。

#### 求导的一些例子

[例 1] 求 $f(x) = x^{\alpha}$ 在 $(0, +\infty)$ 上的导函数。

$\forall x > 0, f'(x) = \displaystyle\lim_{\Delta x \to 0} \frac{(x + \Delta x)^{\alpha} - x^{\alpha}}{\Delta x} = \lim_{\Delta x \to 0} x^{\alpha} \cdot \frac{(1 + \frac{\Delta x}{x})^{\alpha} - 1}{\Delta x} = x^{\alpha} \cdot \lim_{\Delta x \to 0} \frac{\alpha \cdot \frac{\Delta x}{x} + o(\Delta x)}{\Delta x} = \alpha x^{\alpha - 1}$。

[例 2] 求 $f(x) = \sin x$ 在 $\mathbb{R}$ 上的导函数。

$\forall x \in \mathbb{R}, f'(x) = \displaystyle\lim_{\Delta x \to 0} \frac{\sin (x + \Delta x) - \sin x}{\Delta x} = \lim_{\Delta x \to 0} \frac{2 \sin \frac{\Delta x}{2} \cos (x + \frac{\Delta x}{2})}{\Delta x} = (\lim_{y \to 0} \frac{\sin y}{y})(\lim_{y \to 0} \cos (x + y)) = 1 \cdot \cos x = \cos x$。

- 采取类似的手法，可知 $g(x) = \cos x$ 在 $\mathbb{R}$ 上的导函数为 $g'(x) = -\sin x$。

[例 3] 求 $f(x) = e^x$ 在 $\mathbb{R}$ 上的导函数。

$\forall x \in \mathbb{R}, f'(x) = \displaystyle\lim_{\Delta x \to 0} \frac{e^{x + \Delta x} - e^x}{\Delta x} = \lim_{\Delta x \to 0} e^x \cdot \frac{e^{\Delta x} - 1}{\Delta x} = e^x \cdot \lim_{\Delta x \to 0} \frac{\Delta x + o(\Delta x)}{\Delta x} = e^x \cdot 1 = e^x$。

- 采取类似的手法，可知对于 $a > 0$，$g(x) = a^x$ 在 $\mathbb{R}$ 上的导函数为 $g'(x) = a^x \ln a$。

[例 4] 求 $f(x) = \ln x$ 在 $(0, +\infty)$ 上的导函数。

$\forall x > 0, f'(x) = \displaystyle\lim_{\Delta x \to 0} \frac{\ln (x + \Delta x) - \ln x}{\Delta x} = \lim_{\Delta x \to 0} \frac{\ln (1 + \frac{\Delta x}{x})}{\Delta x} = \lim_{\Delta x \to 0} \frac{\frac{\Delta x}{x} + o(\Delta x)}{\Delta x} = \frac{1}{x}$。

- 感性理解：$H_n = \ln n + O(1)$。
- 由上述结论，可知对于 $a > 0$，$g(x) = \log_a x = \dfrac{\ln x}{\ln a}$ 在 $(0, +\infty)$ 上的导函数为 $g'(x) = \dfrac{1}{x \ln a}$。

[例 5] 求 $f(x) = \tan x$ 在 $\mathbb{R} \backslash \{k \pi + \dfrac{\pi}{2} \mid k \in \mathbb{Z}\}$ 上的导函数。

$\forall x \in \mathbb{R} \backslash \{k \pi + \dfrac{\pi}{2} \mid k \in \mathbb{Z}\}, f'(x) = \dfrac{\cos x \cdot \cos x + \sin x \cdot \sin x}{(\cos x)^2} = \dfrac{1}{(\cos x)^2}$。

[例 6] 求 $f(x) = \sin (ax)$ 在 $\mathbb{R}$ 上的导函数。

$\forall x \in \mathbb{R}, f'(x) = \sin' (ax) \cdot (ax)' = a \cos (ax)$。

[例 7] 求 $f(x) = u(x)^{v(x)}$ 的导数。

$f'(x) = (e^{u(x) \ln v(x)})' = e^{u(x) \ln v(x)} \cdot (u(x) \ln v(x))' = u(x)^{v(x)} (u(x) \cdot \dfrac{v'(x)}{v(x)} + u'(x) \ln v(x))$。

[例 8] 求 $f(x) = \arcsin x$ 在 $(-1, 1)$ 上的导数。

令 $g(x) = f^{-1}(x) = \sin x$，则 $f'(x) = \dfrac{1}{g'(f(x))} = \dfrac{1}{\cos (\arcsin x)} = \dfrac{1}{\sqrt{1 - x^2}}$。

[例 9] 考虑椭圆 $\dfrac{x^2}{a^2} + \dfrac{y^2}{b^2} = 1$ 上半部分的参数方程 $\begin{cases} x = a \cos t \\ y = b \sin t \end{cases}, t \in (0, \dfrac{\pi}{2})$，求 $y'(x)$。

$y'(x) = \dfrac{y'(t)}{x'(t)} = -\dfrac{b \cos t}{a \sin t} = -\dfrac{b^2 x}{a^2 y}$。

#### 极坐标

将点 $(x, y)$ 记作 $(r, \theta)$，使得 $\begin{cases} x = r \cos \theta \\ y = r \sin \theta \end{cases}$。

------

给定极坐标下的曲线 $r = r(\theta)$，若满足以下条件，则可求其在 $(r, \theta)$ 处的切线斜率：

- $r(\theta)$ 关于 $\theta$ 严格单调且连续。
- $x(\theta) = r(\theta) \cos \theta, y(\theta) = r(\theta) \sin \theta$ 关于 $\theta$ 可导。
- $x'(\theta) \neq 0$。

故 $y'(x) = \dfrac{y'(\theta)}{x'(\theta)} = \dfrac{r(\theta) \cos \theta + r'(\theta) \sin \theta}{-r(\theta) \sin \theta + r'(\theta) \cos \theta}$。

当 $\cos \theta \neq 0, r'(\theta) \neq 0$，我们可以进一步将原式化简为 $y'(x) = \dfrac{\frac{r(\theta)}{r'(\theta)} + \tan \theta}{1 - \frac{r(\theta)}{r'(\theta)} \tan \theta}$。

由此，注意到该式是一个 $\tan$ 和角形式，这引出了该式的几何意义：

- 原点与 $(x(\theta), y(\theta))$ 连线与 x 轴正方向的夹角为 $\theta$。
- 所求切线与 x 轴正方向的夹角为 $\alpha$，其中 $\tan \alpha = y'(x)$。
- 原点与 $(x(\theta), y(\theta))$ 连线与所求切线的夹角为 $\beta$，其中 $\tan \beta = \dfrac{r(\theta)}{r'(\theta)}$。

#### 隐函数求导

由代数方程 $F(x, y) = 0$ 确定的函数称作隐函数，有的隐函数可以方便地写出显式形式。

若 $y$ 是关于 $x$ 的函数 $y = y(x)$，且 $F(x, y(x))$ 可导，考察 $F(x, y(x))' = 0$，有时可以求出 $y'(x)$。

[例 10] 求 $x^2 + y^2 = 1$ 在 $0 < y \leq 1$ 时 $y = y(x)$ 的导数（表达式可保留 $y(x)$）。

$x^2 + y(x)^2 = 1 \Rightarrow 2x + 2y(x) \cdot y'(x) = 0 \Rightarrow y'(x) = -\dfrac{x}{y(x)}$。

[例 11] 对于关于 $y$ 的函数 $x(y) = y - \epsilon \sin y, \epsilon \in (0, 1)$，证明：其反函数 $y(x)$ 存在；并求 $y'(x)$（表达式可保留 $y(x)$）。

- **注意：我们现在还不知道导数与单调性的关系！**

$\forall y \in \mathbb{R}, \Delta y > 0, x(y + \Delta y) - x(y) = \Delta y + \epsilon (\sin y - \sin (y + \Delta y)) = \Delta y + \epsilon 2 \sin \dfrac{\Delta y}{2} \cos \dfrac{y + \Delta y}{2} \geq \Delta y - 2 \epsilon |\sin \dfrac{\Delta y}{2}| \geq \Delta y - 2 \epsilon \cdot \dfrac{\Delta y}{2} = (1 - \epsilon) \Delta y > 0$，则 $x(y)$ 在 $\mathbb{R}$ 上单调递增。

又有 $x(y)$ 在 $\mathbb{R}$ 上连续，故其反函数 $y(x)$ 存在。

故有 $y(x) - \epsilon \sin y(x) - x = 0 \Rightarrow y'(x) - \epsilon \cos y(x) \cdot y'(x) - 1 = 0 \Rightarrow y'(x) = \dfrac{1}{1 - \epsilon \cos y(x)}$。

#### 对数求导法

[例 12] 对于 $f(x) = \sqrt{\dfrac{x^3}{x - a}} \ (x > \max(0, a))$，求 $f'(x)$。

考虑 $\ln f(x) = \dfrac{1}{2} \ln \dfrac{x^3}{x - a} = \dfrac{3}{2} \ln x - \dfrac{1}{2} \ln (x - a)$。 

左右同时求导，可得 $\dfrac{f'(x)}{f(x)} = \dfrac{3}{2x} - \dfrac{1}{2(x - a)}$。

故 $f'(x) = (\dfrac{3}{2x} - \dfrac{1}{2(x - a)}) \sqrt{\dfrac{x^3}{x - a}}$。

#### 高阶导数

若 $f'(x)$ 在 $U(x_0)$ 存在且在 $x_0$ 处可导，则称 $f$ 在 $x_0$ 处二阶可导，记 $f'(x)$ 在 $x_0$ 处的导数为 $f''(x_0)$。

类似地，我们有 $n \ (n \geq 3)$ 阶可导的定义，记 $f(x)$ 在 $x_0$ 处的 $n$ 阶导数为 $f^{(n)}(x_0)$。